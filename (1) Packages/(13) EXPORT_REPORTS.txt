
                                                  ===============================SPAC=============================

create or replace package "EXPORT_REPORTS" as 
procedure all_export                (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure Export_payment_receive    (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure Export_payment_due        (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure Export_subsidy_apply      (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure Export_subsidy_not_apply  (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure factory_delivery_done     (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure all_export_buyer_wise     (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure EXPORT_PAYMENT_REALISATION_BUYER_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure EXPORT_PAYMENT_DUE_BUYER_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure EXPORT_SUBSIDY_APPLY_BUYER_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure EXPORT_SUBSIDY_NOT_APPLY_BUYER_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure FACTORY_DELIVERY_DONE_BUYER_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure SUBSIDY_AMOUNT_RECEIVE_BUYER_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure SUBSIDY_AMOUNT_DUE_BUYER_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure AUDIT_CERTIFICATE_RECEIVED (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure SUBSIDY_AMOUNT_DUE_BANK_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure ALL_EXPORT_BANK_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure EXPORT_PAYMENT_DUE_BANK_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure Subsidy_amount_Receive (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure Subsidy_amount_due_All_Export (p_company_name varchar2,P_buyer_name varchar2,P_item_name varchar2,P_bank_name number,p_from_date date,p_to_date date); 
procedure Document_submit_done      (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure Document_submit_not_done      (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure ALL_INCOMPLETE_EXPORT (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure PRC_NOT_Apply   (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure PRC_NOT_available   (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure Overdue_list  (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure SUBSIDY_AMOUNT_DUE_ALL_EXPORT_BUYER_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure Subsidy_amount_due (p_company_name varchar2,P_buyer_name varchar2,P_item_name varchar2,P_bank_name number,p_from_date date,p_to_date date); 
procedure DOCUMENT_SUBMIT_BUYER_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure DOCUMENT_SUBMIT_NOT_DONE_BUYER_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
procedure AUDIT_CERTIFICATE_NOT_RECEIVED (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date); 
 
 
end "EXPORT_REPORTS"; 
/



                                                  ===============================BODY=============================

create or replace package body "EXPORT_REPORTS" as 
 procedure all_export (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number      := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' All Export '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p(' 
            <table style="width:100%; font-size: 13px;"> 
            <thead>  
            <tr> 
			<th style="width:1%;position: sticky;" >SL.</th> 
			<th style="width:3%">Factory Delivery<br> Date</th> 
			<th style="width:5%">Exp No</th>  
			<th style="width:4%">EXP ISSUE<br> DATE</th> 
			<th style="width:9%">Purchase Contact No</th> 
            <th style="width:6%">Comercial Invoice No</th> 
            <th style="width:4%">Bank</th> 
            <th style="width:4%">Item </th> 
			<th style="width:3%">Quantity<br>(MT/Bale)</th> 
			<th style="width:4%">Export Value USD</th>  
			<th style="width:5%">Document Submit Date</th> 
			<th style="width:5%">Payment Realisation Date</th> 
            <th style="width:4%">Amount Realise USD</th> 
            <th style="width:4%">Amount Realise BDT</th> 
            <th style="width:3%">Expo Done</th>             
			</tr> 
            </thead>'); 
			 
		FOR r in (SELECT CODE, CODE_DESC  
                    FROM G_UNI_CODES  
                    WHERE P_CODE = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')||'0001' 
                    and CODE = nvl(p_company_name,code)  
                    and org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    ORDER BY CODE) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID); 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="12"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.CODE_DESC) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
         for i in (select 	 m.FACTORYDELIVERYDATE 
                    		,m.EXPFORMNO 
                    		,m.EXPFORMDATE 
                    		,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
                    		,b.SHORT_NAME 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                    		,d.VALUE_USD 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                    		,m.PAYMENTRECEIVEDDATE 
                    		,nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                    		,nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT 
                    		,m.EXPDONE 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID (+)  
                    and m.BANK = b.BANK_ID (+)   
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,nvl(d.BUYER_ID,0)) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID) 
                    order by m.INVOICE_ID desc-- m.FACTORYDELIVERYDATE desc 
                    ) 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	v_usd      := v_usd+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_usd_g    := v_usd_g+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_bdt      := v_bdt+nvl(i.REALIZATIONAMOUNTBDT,0); 
        	v_bdt_g    := v_bdt_g+nvl(i.REALIZATIONAMOUNTBDT,0); 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (to_char(i.FACTORYDELIVERYDATE,'dd-mm-yy')) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (to_char(i.EXPFORMDATE,'dd-mm-yy')) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
               <td style="text-align: left">'||HTF.escape_sc (i.SHORT_NAME) 
                ||'</td> 
               <td style="text-align: left">'|| HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
               <td style="text-align: right">'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.DOCUMENTSUBMISSIONTOBANKDATE,'dd-mm-yy')) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.PAYMENTRECEIVEDDATE,'dd-mm-yy')) 
               ||'</td> 
               <td style="text-align: right">'||HTF.escape_sc (i.REALIZATIONAMOUNTUSD) 
               ||'</td> 
               <td style="text-align: right">'|| HTF.escape_sc (i.REALIZATIONAMOUNTBDT) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.EXPDONE) 
               ||'</td> 
                <tr>'); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="8" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'|| HTF.escape_sc (to_char(v_qty,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_exp)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td  style="text-align: right;" ><b>'||HTF.escape_sc (to_char(v_usd)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="15" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="5" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'|| HTF.escape_sc (TO_CHAR(v_qty_g,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (v_exp_g) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (TO_CHAR(v_usd_g)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (TO_CHAR(v_bdt_g)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
	END;
 
--*******************************
 
    procedure Export_payment_receive (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number      := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' Export Payment Receive '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
 
 
			htp.p('<table style="width:100%;font-size:11px;"><tr> 
			<th  STYLE="width:1%" >SL.</th> 
			<th style="width:6%">Factory Delivery<br> Date</th> 
			<th STYLE="width:10%">Exp No</th>  
			<th style="width:8%">EXP ISSUE<br> DATE</th> 
			<th STYLE="width:22%">Purchase Contact No</th> 
            <th STYLE="width:15%">Comercial Invoice No</th> 
            <th STYLE="width:11%">Bank </th> 
            <th style="width:9%">Item </th> 
			<th STYLE="width:3%">Quantity<br>(MT/Bale)</th> 
			<th STYLE="width:4%">Export Value USD</th>  
			<th STYLE="width:5%">Document Submit Date</th> 
			<th style="width:5%">Payment Realisation Date</th> 
            <th STYLE="width:4%">Amount Realise USD</th> 
            <th STYLE="width:4%">Amount Realise BDT</th> 
            <th STYLE="width:3%">Expo<br>Done</th> 
             
			</tr>'); 
	 
		FOR r in (SELECT CODE, CODE_DESC  
                    FROM G_UNI_CODES  
                    WHERE P_CODE =APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')||'0001' 
                    and CODE = nvl(p_company_name,code)  
                    and org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    ORDER BY CODE) 
		LOOP 
      
     		 
            select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID (+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and trunc(nvl(PAYMENTRECEIVEDDATE,p_to_date)) between p_from_date and p_to_date 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID) 
                    -- and (REALIZATIONAMOUNTUSD is not null or REALIZATIONSUBSIDYBDT is not null) 
                    -- and FACTORYDELIVERYDATE is not null 
                    -- and nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT is not null 
                    AND PAYMENTRECEIVEDDATE is not null; 
 
if v_count > 0  then 
            HTP.p ( 
                  '<tr> 
                <td colspan="15"  style="text-align: left">' 
               || HTF.escape_sc (r.CODE_DESC) 
               || '</td> 
                </tr>'); 
end if; 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
         for i in (select 	 m.FACTORYDELIVERYDATE 
                    		,m.EXPFORMNO 
                    		,m.EXPFORMDATE 
                    		,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
                    		,b.SHORT_NAME 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                    		,d.VALUE_USD 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                    		,m.PAYMENTRECEIVEDDATE 
                    		,nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                    		,nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT 
                    		,m.EXPDONE 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID (+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and trunc(nvl(PAYMENTRECEIVEDDATE,p_to_date)) between p_from_date and p_to_date 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID) 
                    -- and (REALIZATIONAMOUNTUSD is not null or REALIZATIONSUBSIDYBDT is not null) 
                    -- and FACTORYDELIVERYDATE is not null 
                    -- and nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT is not null 
                    AND PAYMENTRECEIVEDDATE is not null
                    order by  m.PAYMENTRECEIVEDDATE asc ) 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	v_usd      := v_usd+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_usd_g    := v_usd_g+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_bdt      := v_bdt+nvl(i.REALIZATIONAMOUNTBDT,0); 
        	v_bdt_g    := v_bdt_g+nvl(i.REALIZATIONAMOUNTBDT,0); 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (to_char(i.FACTORYDELIVERYDATE,'dd-mm-yy')) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: CENTER">' 
               || HTF.escape_sc (to_char(i.EXPFORMDATE,'dd-mm-yy')) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
               <td style="text-align: left">'||HTF.escape_sc (i.SHORT_NAME) 
                ||'</td> 
               <td style="text-align: CENTER">'|| HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
               <td style="text-align: right">'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.DOCUMENTSUBMISSIONTOBANKDATE,'dd-mm-yy')) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.PAYMENTRECEIVEDDATE,'dd-mm-yy')) 
               ||'</td> 
               <td style="text-align: right">'||HTF.escape_sc (i.REALIZATIONAMOUNTUSD) 
               ||'</td> 
               <td style="text-align: right">'|| HTF.escape_sc (i.REALIZATIONAMOUNTBDT) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.EXPDONE) 
               ||'</td> 
                </tr>'); 
			end loop; 
             
if v_count > 0  then 
            HTP.p ( 
                  '<tr> 
                <td colspan="8" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'|| HTF.escape_sc (to_char(v_qty,'99,99,999')) 
               ||'</b></td> 
               <td ><b>'||HTF.escape_sc (to_char(v_exp)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td  style="text-align: right;" ><b>'||HTF.escape_sc (to_char(v_usd)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt)) 
               ||'</b></td> 
               <td></td> 
                </tr>'); 
end if; 
	 
		end loop; 
 
            HTP.p ( 
                  '<tr> 
                <td colspan="15" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="5" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'|| HTF.escape_sc (to_char(v_qty_g,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_exp_g)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (to_char(v_usd_g)) 
               ||'</b></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (to_char(v_bdt_g)) 
               ||'</b></td> 
               <td></td> 
                </tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
	END; 
 
--******************************

    procedure Export_payment_due  (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
    v_count number      := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' Export Payment Due '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size:11px;"><tr> 
			<th style="width:1%">SL.</th> 
			<th style="width:12%">Buyer Name</th> 
			<th style="width:3%">Factory Delivery<br> Date</th> 
			<th style="width:10%">Exp No</th>  
			<th style="width:6%">EXP ISSUE<br> DATE</th> 
			<th style="width:15%">Purchase Contact No</th> 
            <th style="width:10%">Commercial Invoice No</th> 
            <th style="width:6%">Bank</th> 
            <th style="width:9%">Item</th> 
			<th style="width:3%">Quantity<br>(MT/Bale)</th> 
			<th style="width:5%">Export Value Usd</th>  
			<th style="width:6%">Document Submit Date</th> 
            <th STYLE="width:3%">Expo<br>Done</th> 
             
			</tr>'); 
		FOR r in (SELECT CODE, CODE_DESC  
                    FROM G_UNI_CODES  
                    WHERE P_CODE =APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')||'0001' 
                    and CODE = nvl(p_company_name,code)  
                    and org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    ORDER BY CODE) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                     and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(DOCUMENTSUBMISSIONTOBANKDATE,p_to_date) between p_from_date and p_to_date 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID) 
                    and FACTORYDELIVERYDATE is not null 
                    AND PAYMENTRECEIVEDDATE is null; 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="15"  style="text-align: left">' 
               || HTF.escape_sc (r.CODE_DESC) 
               || '</td> 
                <tr>'); 
end if; 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
         for i in (select 	 m.FACTORYDELIVERYDATE 
                            , (SELECT EB.BUYER_NAME FROM ERP_BUYER_INFO EB, ERP_PURCHASE_CONTRACT PC WHERE EB.BUYER_ID = PC.BUYER_ID AND PC.PC_ID = m.PURCHASECONTACTID) BUYER 
                    		,m.EXPFORMNO 
                    		,m.EXPFORMDATE 
                    		,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
                    		,b.SHORT_NAME 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                    		,d.VALUE_USD 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                    		,m.PAYMENTRECEIVEDDATE 
                    		,nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                    		,nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT 
                    		,m.EXPDONE 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID (+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(DOCUMENTSUBMISSIONTOBANKDATE,p_to_date) between p_from_date and p_to_date 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID) 
                    and FACTORYDELIVERYDATE is not null 
                    AND PAYMENTRECEIVEDDATE is null  
                    ORDER BY m.FACTORYDELIVERYDATE desc) 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	v_usd      := v_usd+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_usd_g    := v_usd_g+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_bdt      := v_bdt+nvl(i.REALIZATIONAMOUNTBDT,0); 
        	v_bdt_g    := v_bdt_g+nvl(i.REALIZATIONAMOUNTBDT,0); 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (i.BUYER) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (to_char(i.FACTORYDELIVERYDATE,'dd-mm-yy')) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (to_char(i.EXPFORMDATE,'dd-mm-yy')) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align:Left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
               <td>'||HTF.escape_sc (i.SHORT_NAME) 
                ||'</td> 
               <td>'|| HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
               <td style="text-align: right">'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.DOCUMENTSUBMISSIONTOBANKDATE,'dd-mm-yy')) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.EXPDONE) 
               ||'</td> 
                <tr>'); 
		end loop; 
             
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="9" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'|| HTF.escape_sc (to_char(v_qty,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_exp)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
            HTP.p ( 
                  '<tr> 
                <td colspan="15" style="text-align: right;">.</td><tr> 
               <td colspan="4"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="5" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'|| HTF.escape_sc (TO_CHAR(v_qty_g,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_exp_g)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
                <tr>'); 
			htp.p('</table>'); 
 
		report_utils.footer; 
         
	END; 
 
--**************************
 
    procedure Export_subsidy_apply (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number  := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' Export Subsidy Apply '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size:11px;"><tr> 
			<th style="width:1%" >SL.</th> 
			<th style="width:5%">Factory Delivery<br> Date</th> 
			<th style="width:10%">Exp No</th>  
			<th style="width:18%">Purchase Contact No</th> 
            <th style="width:10%">Comercial Invoice No</th> 
            <th style="width:9%">Bank</th> 
            <th style="width:7%">Item</th> 
			<th style="width:3%">Quantity<br>(MT/Bale)</th> 
			<th style="width:5%">Value USD</th>  
			<th style="width:5%">Document Submit Date</th> 
			<th style="width:5%">Amount Realise Date</th> 
            <th style="width:4%">Amount Realise USD</th> 
            <th style="width:4%">Amount Realise BDT</th> 
            <th style="width:6%">Subsidy Apply Date</th> 
             
			</tr>'); 
						 
		FOR r in (SELECT CODE, CODE_DESC  
                    FROM G_UNI_CODES  
                    WHERE P_CODE =APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')||'0001' 
                    and CODE = nvl(p_company_name,code)  
                    and org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    ORDER BY CODE) 
		LOOP 
 
        select count(*) into v_count 
                     FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID (+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID) 
                    and nvl(APPLYFORSUBSIDYDATE,p_to_date) between p_from_date and p_to_date 
                    AND m.APPLYFORSUBSIDYDATE IS NOT NULL 
                    AND m.PAYMENTRECEIVEDDATE IS NOT NULL; 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="12"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.CODE_DESC) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
         for i in (select 	 m.FACTORYDELIVERYDATE 
                    		,m.EXPFORMNO 
                    		,m.EXPFORMDATE 
                    		,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
                    		,b.SHORT_NAME 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                    		,d.VALUE_USD 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                    		,m.PAYMENTRECEIVEDDATE 
                    		,nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                    		,nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT 
                    		,m.APPLYFORSUBSIDYDATE 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID (+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID) 
                    and nvl(APPLYFORSUBSIDYDATE,p_to_date) between p_from_date and p_to_date 
                    AND m.APPLYFORSUBSIDYDATE IS NOT NULL 
                    AND m.PAYMENTRECEIVEDDATE IS NOT NULL 
                    ORDER BY APPLYFORSUBSIDYDATE asc
                    ) 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	v_usd      := v_usd+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_usd_g    := v_usd_g+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_bdt      := v_bdt+nvl(i.REALIZATIONAMOUNTBDT,0); 
        	v_bdt_g    := v_bdt_g+nvl(i.REALIZATIONAMOUNTBDT,0); 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (to_char(i.FACTORYDELIVERYDATE,'dd-mm-yy')) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
               <td style="text-align: left">'||HTF.escape_sc (i.SHORT_NAME) 
                ||'</td> 
               <td style="text-align: CENTER">'|| HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
               <td style="text-align: right">'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.DOCUMENTSUBMISSIONTOBANKDATE,'dd-mm-yy')) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.PAYMENTRECEIVEDDATE,'dd-mm-yy')) 
               ||'</td> 
               <td style="text-align: right">'||HTF.escape_sc (i.REALIZATIONAMOUNTUSD) 
               ||'</td> 
               <td style="text-align: right">'|| HTF.escape_sc (i.REALIZATIONAMOUNTBDT) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.APPLYFORSUBSIDYDATE,'dd-mm-yy')) 
               ||'</td> 
                <tr>'); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="7" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'|| HTF.escape_sc (to_char(v_qty,'99,99,999')) 
               ||'</b></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (to_char(v_exp)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (to_char(v_usd)) 
               ||'</b></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (to_char(v_bdt)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="13" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="4" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'|| HTF.escape_sc (TO_CHAR(v_qty_g,'99,99,999')) 
               ||'</b></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (to_char(v_exp_g)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (to_char(v_usd_g)) 
               ||'</b></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (to_char(v_bdt_g)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
         
	END;
 
--****************************
 
 procedure Export_subsidy_not_apply (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number  := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' Export Subsidy Not Apply '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size:11px;"><tr> 
			<th style="width:1%" >SL.</th> 
			<th style="width:3%">Factory Delivery<br> Date</th> 
			<th style="width:10%">Exp No</th>  
			<th style="width:15%">Purchase Contact No</th> 
            <th style="width:8%">Comercial Invoice No</th> 
            <th style="width:7%">Bank</th> 
            <th style="width:7%">Item </th> 
			<th style="width:3%">Quantity<br>(MT/Bale)</th> 
			<th style="width:4%">Value USD</th>  
			<th style="width:5%">Document Submit Date</th> 
			<th style="width:5%">Amount Realise Date</th> 
            <th style="width:4%">Amount Realise USD</th> 
            <th style="width:4%">Amount Realise BDT</th> 
            <th style="width:6%">Subsidy Apply Date</th> 
             
			</tr>'); 
						 
		FOR r in (SELECT CODE, CODE_DESC  
                    FROM G_UNI_CODES  
                    WHERE P_CODE =APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')||'0001' 
                    and CODE = nvl(p_company_name,code)  
                    and org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    ORDER BY CODE) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    AND m.APPLYFORSUBSIDYDATE IS  NULL 
                    ---AND m.PAYMENTRECEIVEDDATE IS  NULL
                    AND m.FACTORYDELIVERYDATE IS NOT NULL 
                    and m.DOCUMENTSUBMISSIONTOBANKDATE is not null 
                    and m.PAYMENTRECEIVEDUSD > 0  
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID); 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="12"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.CODE_DESC) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
         for i in (select 	 m.FACTORYDELIVERYDATE 
                    		,m.EXPFORMNO 
                    		,m.EXPFORMDATE 
                    		,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
                    		,b.SHORT_NAME 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                    		,d.VALUE_USD 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                    		,m.PAYMENTRECEIVEDDATE 
                    		,nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                    		,nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT 
                    		,m.APPLYFORSUBSIDYDATE 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(FACTORYDELIVERYDATE,p_to_date) between p_from_date and p_to_date 
                    AND m.APPLYFORSUBSIDYDATE IS NULL 
                   -- AND m.PAYMENTRECEIVEDDATE IS  NULL 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID) 
                    AND m.FACTORYDELIVERYDATE IS NOT NULL 
                    and m.DOCUMENTSUBMISSIONTOBANKDATE is not null 
                    and m.PAYMENTRECEIVEDUSD > 0 
                     ORDER BY m.FACTORYDELIVERYDATE DESC) 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	v_usd      := v_usd+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_usd_g    := v_usd_g+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_bdt      := v_bdt+nvl(i.REALIZATIONAMOUNTBDT,0); 
        	v_bdt_g    := v_bdt_g+nvl(i.REALIZATIONAMOUNTBDT,0); 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.FACTORYDELIVERYDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
               <td style="text-align: left">'||HTF.escape_sc (i.SHORT_NAME) 
                ||'</td> 
               <td style="text-align: left">'|| HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
               <td>'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.DOCUMENTSUBMISSIONTOBANKDATE,'DD-MM-YY')) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.PAYMENTRECEIVEDDATE,'DD-MM-YY')) 
               ||'</td> 
               <td style="text-align: RIGHT">'||HTF.escape_sc (i.REALIZATIONAMOUNTUSD) 
               ||'</td> 
               <td style="text-align: RIGHT">'|| HTF.escape_sc (i.REALIZATIONAMOUNTBDT) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.APPLYFORSUBSIDYDATE,'DD-MM-YY')) 
               ||'</td> 
                <tr>'); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="7" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'|| HTF.escape_sc (to_char(v_qty,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_exp)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td  style="text-align: right;" ><b>'||HTF.escape_sc (to_char(v_usd)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="13" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="4" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'|| HTF.escape_sc (TO_CHAR(v_qty_g,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (v_exp_g) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (to_char(v_usd_g)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt_g)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
        
	END; 

--***************************
 
procedure factory_delivery_done (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
    v_sl_g   number     := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number  := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' Factory Delivery Done  '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size:11px;"><tr> 
			<th style="width:1%" >SL.</th> 
			<th style="width:4%">Factory Delivery<br> Date</th> 
			<th style="width:12%">Buyer Name</th> 
			<th style="width:5%">Exp No</th>  
			<th style="width:4%">EXP ISSUE<br> DATE</th> 
			<th style="width:10%">Purchase Contact No</th> 
            <th style="width:10%">Comercial Invoice No</th>  
            <th style="width:7%">Bank</th> 
			<th style="width:3%">Export Value USD</th> 
            <th style="width:7%">Items</th> 
			<th style="width:2%">MT</th> 
			<th style="width:5%">Payment <br>Realisation Date</th>
             
			</tr>'); 
			 
		FOR r in (SELECT CODE, CODE_DESC  
                    FROM G_UNI_CODES  
                    WHERE P_CODE =APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')||'0001' 
                    and CODE = nvl(p_company_name,code)  
                    and org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    ORDER BY CODE) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(FACTORYDELIVERYDATE,p_to_date) between p_from_date and p_to_date 
                    and( m.FACTORYDELIVERYDATE is not null 
                    or m.EXPDONE = upper('YES')) 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID); 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="11"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.CODE_DESC) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
            v_tot_sl    := 0; 
        	 
         for i in (select 	 m.FACTORYDELIVERYDATE 
                    		,m.EXPFORMNO 
                    		,m.EXPFORMDATE 
                    		,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
							,m.COMMERCIALINVOICEDATE 
                    		,m.PAYMENTRECEIVEDDATE 
                    		,b.SHORT_NAME 
							,d.VALUE_USD 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                            ,(select buyer_name from ERP_BUYER_INFO where buyer_id = d.BUYER_ID) buyer_name
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(FACTORYDELIVERYDATE,p_to_date) between p_from_date and p_to_date 
                    and( m.FACTORYDELIVERYDATE is not null 
                    or m.EXPDONE = upper('YES')) 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID) 
                     ORDER BY m.FACTORYDELIVERYDATE DESC) 
                    loop 
            v_sl := v_sl+1; 
            v_sl_g := v_sl_g+1; 
            v_tot_sl   := v_tot_sl + nvl(v_sl,0); 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.FACTORYDELIVERYDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.buyer_name) 
               || '</td>
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.EXPFORMDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td>  
               <td style="text-align: left">'||HTF.escape_sc (i.SHORT_NAME) 
                ||'</td> 
				 <td>'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td style="text-align: left">'|| HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
			    <td style="text-align: center">' 
               || HTF.escape_sc (to_char(i.PAYMENTRECEIVEDDATE,'DD-MM-YY')) 
               || '</td>'); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="8" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'|| HTF.escape_sc (to_char(v_exp,'99,99,999')) 
               ||'</b></td> 
               <td></td> 
 
               <td><b>'||HTF.escape_sc (to_char(v_qty)) 
               ||'</b></td> 
               <td></td> 
                
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="12" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Result : '||HTF.escape_sc (v_sl_g) 
               ||'</b></td> 
                <td colspan="5" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'|| HTF.escape_sc (TO_CHAR(v_exp_g,'99,99,99,99,999')) 
               ||'</b></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (v_qty_g) 
               ||'</b></td>
               <td></td>  
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
         
	END; 
 
--****************************
 
 procedure all_export_buyer_wise (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number  := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' ALL Export Statement '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size:11px;"><tr> 
			<th style="width:1%" >SL.</th> 
			<th style="width:3%">Factory Delivery<br> Date</th> 
			<th style="width:5%">Exp No</th>  
			<th style="width:5%">EXP ISSUE<br> DATE</th> 
			<th style="width:16%">Purchase Contact No</th> 
            <th style="width:10%">Comercial Invoice No</th> 
            <th style="width:6%">Bank</th> 
            <th style="width:7%">Item</th> 
			<th style="width:3%">Quantity<br>(MT/Bale</th> 
			<th style="width:4%">Export Value USD</th>  
			<th style="width:5%">Document Submit Date</th> 
			<th style="width:5%">Payment Realisation Date</th> 
            <th style="width:2%">Amount Realise USD</th> 
            <th style="width:2%">Amount Realise BDT</th> 
            <th style="width:2%">Expo Done</th> 
             
			</tr>'); 
			 
		FOR r in (SELECT SHORT_NAME ,BUYER_NAME, BUYER_ID  
                    FROM ERP_BUYER_INFO 
                    where BUYER_ID = nvl(p_buyer_name,BUYER_ID) 
                    AND org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
					and m.COMPANYID = nvl(p_company_name,m.COMPANYID) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and d.BUYER_ID = r.BUYER_ID 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and FACTORYDELIVERYDATE is not null
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                   ; 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="12"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.BUYER_NAME) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
         for i in (select 	 m.FACTORYDELIVERYDATE 
                    		,m.EXPFORMNO 
                    		,m.EXPFORMDATE 
                    		,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
                    		,b.SHORT_NAME 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                    		,d.VALUE_USD 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                    		,m.PAYMENTRECEIVEDDATE 
                    		,nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                    		,nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT 
                    		,m.EXPDONE 
                     FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
					and m.COMPANYID = nvl(p_company_name,m.COMPANYID) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and d.BUYER_ID = r.BUYER_ID 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    and FACTORYDELIVERYDATE is not null
                     ORDER BY m.FACTORYDELIVERYDATE DESC,m.EXPDONE) 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	v_usd      := v_usd+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_usd_g    := v_usd_g+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_bdt      := v_bdt+nvl(i.REALIZATIONAMOUNTBDT,0); 
        	v_bdt_g    := v_bdt_g+nvl(i.REALIZATIONAMOUNTBDT,0); 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.FACTORYDELIVERYDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (TO_CHAR(i.EXPFORMDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
               <td style="text-align: left;font-size:10px;">'||HTF.escape_sc (i.SHORT_NAME) 
                ||'</td> 
               <td style="text-align: left">'|| HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
               <td>'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.DOCUMENTSUBMISSIONTOBANKDATE,'DD-MM-YY')) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.PAYMENTRECEIVEDDATE,'dd-mm-yy')) 
               ||'</td> 
               <td style="text-align: RIGHT">'||HTF.escape_sc (i.REALIZATIONAMOUNTUSD) 
               ||'</td> 
               <td style="text-align: RIGHT">'|| HTF.escape_sc (i.REALIZATIONAMOUNTBDT) 
               ||'</td> 
               <td '||case when i.EXPDONE = 'CANCEL' then 'bgcolor= "yellow"' end ||'>'||HTF.escape_sc (i.EXPDONE) 
               ||'</td> 
                <tr>'); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="8" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'|| HTF.escape_sc (to_char(v_qty,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_exp)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td  style="text-align: right;" ><b>'||HTF.escape_sc (to_char(v_usd)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="15" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
 
                <td colspan="5" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'|| HTF.escape_sc (TO_CHAR(v_qty_g,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (v_exp_g) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (to_char(v_usd_g)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt_g)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
        
	END; 

--*****************************

 procedure EXPORT_PAYMENT_REALISATION_BUYER_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number  := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, '  Export Payment Realisation Due '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%"><tr> 
			<th style="width:1%" >SL.</th> 
			<th style="width:3%">Factory Delivery<br> Date</th> 
			<th style="width:5%">Exp No</th>  
			<th style="width:4%">EXP ISSUE<br> DATE</th> 
			<th style="width:15%">Purchase Contact No</th> 
            <th style="width:10%">Comercial Invoice No</th> 
            <th style="width:4%">Bank</th> 
            <th style="width:5%">Item</th> 
			<th style="width:4%">Quantity(MT/Bale</th> 
			<th style="width:4%">Export Value USD</th>  
			<th style="width:6%">Document Submit Date</th> 
			<th style="width:6%">Payment Realisation Date</th> 
            <th style="width:4%">Amount Realise USD</th> 
            <th style="width:4%">Amount Realise BDT</th> 
            <th style="width:2%">Expo Done</th> 
             
			</tr>'); 
			 
		FOR r in (SELECT SHORT_NAME BUYER_NAME, BUYER_ID  
                    FROM ERP_BUYER_INFO 
                    where BUYER_ID = nvl(p_buyer_name,BUYER_ID) 
                    AND org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
					and m.COMPANYID = nvl(p_company_name,m.COMPANYID) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and d.BUYER_ID = r.BUYER_ID 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    --and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    and nvl(PAYMENTRECEIVEDDATE,p_to_date) between p_from_date and p_to_date 
                    and (REALIZATIONAMOUNTUSD is not null or REALIZATIONAMOUNTBDT is not null) 
                    and FACTORYDELIVERYDATE is not null 
                    AND PAYMENTRECEIVEDDATE is not null 
                     
                    ; 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="12"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.BUYER_NAME) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
         for i in (select 	 m.FACTORYDELIVERYDATE 
                    		,m.EXPFORMNO 
                    		,m.EXPFORMDATE 
                    		,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
                    		,b.SHORT_NAME 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                    		,d.VALUE_USD 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                    		,m.PAYMENTRECEIVEDDATE 
                    		,nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                    		,nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT 
                    		,m.EXPDONE 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
					and m.COMPANYID = nvl(p_company_name,m.COMPANYID) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and d.BUYER_ID = r.BUYER_ID 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                   -- and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date  
                    and nvl(PAYMENTRECEIVEDDATE,p_to_date) between p_from_date and p_to_date 
                    and (REALIZATIONAMOUNTUSD is not null or REALIZATIONAMOUNTBDT is not null) 
                    and FACTORYDELIVERYDATE is not null 
                    AND PAYMENTRECEIVEDDATE is not null 
                     ORDER BY m.FACTORYDELIVERYDATE DESC 
                    ) 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	v_usd      := v_usd+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_usd_g    := v_usd_g+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_bdt      := v_bdt+nvl(i.REALIZATIONAMOUNTBDT,0); 
        	v_bdt_g    := v_bdt_g+nvl(i.REALIZATIONAMOUNTBDT,0); 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.FACTORYDELIVERYDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.EXPFORMDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
               <td style="text-align: left">'||HTF.escape_sc (i.SHORT_NAME) 
                ||'</td> 
               <td style="text-align: left">'|| HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
               <td>'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.DOCUMENTSUBMISSIONTOBANKDATE,'DD-MM-YY')) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.PAYMENTRECEIVEDDATE,'dd-mm-yy')) 
               ||'</td> 
               <td style="text-align: RIGHT">'||HTF.escape_sc (i.REALIZATIONAMOUNTUSD) 
               ||'</td> 
               <td style="text-align: RIGHT">'|| HTF.escape_sc (i.REALIZATIONAMOUNTBDT) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.EXPDONE) 
               ||'</td> 
                <tr>'); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="8" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'|| HTF.escape_sc (to_char(v_qty,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_exp)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td  style="text-align: right;" ><b>'||HTF.escape_sc (to_char(v_usd)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="15" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="5" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'|| HTF.escape_sc (TO_CHAR(v_qty_g,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (v_exp_g) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (to_char(v_usd_g)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt_g)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
         
	END;
 
--*****************************
 
 procedure EXPORT_PAYMENT_DUE_BUYER_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number  := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, '  Export Payment Realisation Due (Buyer Wise) '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%; font-size: 11px;"><tr> 
			<th style="width:1%" >SL.</th> 
			<th style="width:3%">Factory Delivery<br> Date</th> 
			<th style="width:5%">Exp No</th>  
			<th style="width:5%">EXP ISSUE<br> DATE</th> 
			<th style="width:15%">Purchase Contact No</th> 
            <th style="width:10%">Comercial Invoice No</th> 
            <th style="width:4%">Bank</th> 
            <th style="width:6%">Item</th> 
			<th style="width:4%">Quantity<br>(MT/Bale</th> 
			<th style="width:4%">Export Value USD</th>  
			<th style="width:6%">Document Submit Date</th> 
			<th style="width:6%">Payment Realisation Date</th> 
            <th style="width:2%">Amount Realise USD</th> 
            <th style="width:2%">Amount Realise BDT</th> 
            <th style="width:2%">Expo Done</th> 
             
			</tr>'); 
			 
		FOR r in (SELECT SHORT_NAME, BUYER_NAME, BUYER_ID  
                    FROM ERP_BUYER_INFO 
                    where BUYER_ID = nvl(p_buyer_name,BUYER_ID) 
                    AND org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
					and m.COMPANYID = nvl(p_company_name,m.COMPANYID)					 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and d.BUYER_ID = r.BUYER_ID 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(FACTORYDELIVERYDATE,p_to_date) between p_from_date and p_to_date
                     and FACTORYDELIVERYDATE is not null 
                     AND PAYMENTRECEIVEDDATE is null 
                   ; 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="12"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.BUYER_NAME) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
         for i in (select 	 m.FACTORYDELIVERYDATE 
                    		,m.EXPFORMNO 
                    		,m.EXPFORMDATE 
                    		,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
                    		,b.SHORT_NAME 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                    		,d.VALUE_USD 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                    		,m.PAYMENTRECEIVEDDATE 
                    		,nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                    		,nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT 
                    		,m.EXPDONE 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
					and m.COMPANYID = nvl(p_company_name,m.COMPANYID)					 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and d.BUYER_ID = r.BUYER_ID 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(FACTORYDELIVERYDATE,p_to_date) between p_from_date and p_to_date 
                     AND PAYMENTRECEIVEDDATE is null 
                     and FACTORYDELIVERYDATE is not null
                      ORDER BY m.FACTORYDELIVERYDATE DESC,m.EXPDONE 
                     
                    ) 
					 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	v_usd      := v_usd+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_usd_g    := v_usd_g+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_bdt      := v_bdt+nvl(i.REALIZATIONAMOUNTBDT,0); 
        	v_bdt_g    := v_bdt_g+nvl(i.REALIZATIONAMOUNTBDT,0); 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.FACTORYDELIVERYDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.EXPFORMDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
               <td style="text-align: left">'||HTF.escape_sc (i.SHORT_NAME) 
                ||'</td> 
               <td style="text-align: left;font-size: 10px;">'|| HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
               <td>'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.DOCUMENTSUBMISSIONTOBANKDATE,'DD-MM-YY')) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.PAYMENTRECEIVEDDATE,'dd-mm-yy')) 
               ||'</td> 
               <td style="text-align: RIGHT">'||HTF.escape_sc (i.REALIZATIONAMOUNTUSD) 
               ||'</td> 
               <td style="text-align: RIGHT">'|| HTF.escape_sc (i.REALIZATIONAMOUNTBDT) 
               ||'</td> 
               <td '||case when i.EXPDONE = 'CANCEL' then 'bgcolor= "yellow"' end ||'>'||HTF.escape_sc (i.EXPDONE) 
               ||'</td> 
                <tr>'); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="8" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'|| HTF.escape_sc (to_char(v_qty,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_exp)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td  style="text-align: right;" ><b>'||HTF.escape_sc (to_char(v_usd)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="15" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="5" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'|| HTF.escape_sc (TO_CHAR(v_qty_g,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (v_exp_g) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (to_char(v_usd_g)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt_g)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
         
	END;
 
--****************************

 procedure EXPORT_SUBSIDY_APPLY_BUYER_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number      := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' EXPORT STATEMENT SUBSIDY NOT YET APPLY '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size: 11px;"><tr> 
			<th style="width:1%" >SL.</th> 
			<th style="width:3%">Factory Delivery<br> Date</th> 
			<th style="width:5%">Exp No</th>  
			<th style="width:15%">Purchase Contact No</th> 
            <th style="width:10%">Comercial Invoice No</th> 
            <th style="width:6%">Bank</th> 
            <th style="width:7%">Item</th> 
			<th style="width:4%">Export Value USD</th>  
			<th style="width:6%">Document Submit Date</th> 
			<th style="width:6%">Payment Realisation Date</th> 
            <th style="width:2%">Amount Realise USD</th> 
            <th style="width:2%">Amount Realise BDT</th> 
            <th style="width:4%">PRC Apply Date</th> 
             
			</tr>'); 
			 
		FOR r in (SELECT SHORT_NAME, BUYER_NAME, BUYER_ID  
                    FROM ERP_BUYER_INFO 
                    where BUYER_ID = nvl(p_buyer_name,BUYER_ID) 
                    AND org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
					and m.COMPANYID = nvl(p_company_name,m.COMPANYID)					 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and d.BUYER_ID = r.BUYER_ID 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                   -- and nvl(APPLYFORSUBSIDYDATE,p_to_date) between p_from_date and p_to_date 
                    AND m.APPLYFORSUBSIDYDATE IS NOT NULL 
                    AND m.PAYMENTRECEIVEDDATE IS NOT NULL
                    and FACTORYDELIVERYDATE is not null 
                    ; 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="13"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.BUYER_NAME) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
         for i in (select 	 m.FACTORYDELIVERYDATE 
                    		,m.EXPFORMNO 
                    		,m.EXPFORMDATE 
                    		,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
                    		,b.SHORT_NAME 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                    		,d.VALUE_USD 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                    		,m.PAYMENTRECEIVEDDATE 
                    		,nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                    		,nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT 
                    		,m.APPLYFORPRCDATE 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
					and m.COMPANYID = nvl(p_company_name,m.COMPANYID)					 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and d.BUYER_ID = r.BUYER_ID 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    --and nvl(APPLYFORSUBSIDYDATE,p_to_date) between p_from_date and p_to_date 
                    AND m.APPLYFORSUBSIDYDATE IS NOT NULL 
                    AND m.PAYMENTRECEIVEDDATE IS NOT NULL 
                    and FACTORYDELIVERYDATE is not null 
                     ORDER BY m.FACTORYDELIVERYDATE DESC 
                    ) 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	v_usd      := v_usd+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_usd_g    := v_usd_g+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_bdt      := v_bdt+nvl(i.REALIZATIONAMOUNTBDT,0); 
        	v_bdt_g    := v_bdt_g+nvl(i.REALIZATIONAMOUNTBDT,0); 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.FACTORYDELIVERYDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
               <td style="text-align: left">'||HTF.escape_sc (i.SHORT_NAME) 
                ||'</td> 
               <td style="text-align: left">'|| HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.DOCUMENTSUBMISSIONTOBANKDATE,'DD-MM-YY')) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.PAYMENTRECEIVEDDATE,'dd-mm-yy')) 
               ||'</td> 
               <td style="text-align: RIGHT">'||HTF.escape_sc (i.REALIZATIONAMOUNTUSD) 
               ||'</td> 
               <td style="text-align: RIGHT">'|| HTF.escape_sc (i.REALIZATIONAMOUNTBDT) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.APPLYFORPRCDATE,'dd-mm-yy')) 
               ||'</td> 
                <tr>'); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="7" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'||HTF.escape_sc (to_char(v_exp)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td  style="text-align: right;" ><b>'||HTF.escape_sc (to_char(v_usd)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="13" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="4" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'||HTF.escape_sc (v_exp_g) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (to_char(v_usd_g)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt_g)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
        
	END; 

--**************************
 
 procedure EXPORT_SUBSIDY_NOT_APPLY_BUYER_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number      := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' EXPORT STATEMENT SUBSIDY NOT YET APPLY '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size: 11px;"><tr> 
			<th style="width:1%" >SL.</th> 
			<th style="width:3%">Factory Delivery<br> Date</th> 
			<th style="width:5%">Exp No</th>  
			<th style="width:15%">Purchase Contact No</th> 
            <th style="width:10%">Comercial Invoice No</th> 
            <th style="width:6%">Bank</th> 
            <th style="width:7%">Item</th> 
			<th style="width:4%">Export Value USD</th>  
			<th style="width:6%">Document Submit Date</th> 
			<th style="width:6%">Payment Realisation Date</th> 
            <th style="width:42">Amount Realise USD</th> 
            <th style="width:2%">Amount Realise BDT</th> 
            <th style="width:5%">Apply For PRC Date</th> 
             
			</tr>'); 
			 
		FOR r in (SELECT SHORT_NAME ,BUYER_NAME, BUYER_ID  
                    FROM ERP_BUYER_INFO 
                    where BUYER_ID = nvl(p_buyer_name,BUYER_ID) 
                    AND org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
					and m.COMPANYID = nvl(p_company_name,m.COMPANYID) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and d.BUYER_ID = r.BUYER_ID 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    --and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    and nvl(FACTORYDELIVERYDATE,p_to_date) between p_from_date and p_to_date 
                    AND m.APPLYFORSUBSIDYDATE IS NULL
                    and FACTORYDELIVERYDATE is not null  
                    ; 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="13"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.BUYER_NAME) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
         for i in (select 	 m.FACTORYDELIVERYDATE 
                    		,m.EXPFORMNO 
                    		,m.EXPFORMDATE 
                    		,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
                    		,b.SHORT_NAME 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                    		,d.VALUE_USD 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                    		,m.PAYMENTRECEIVEDDATE 
                    		,nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                    		,nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT 
                    		,m.APPLYFORPRCDATE 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
					and m.COMPANYID = nvl(p_company_name,m.COMPANYID) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and d.BUYER_ID = r.BUYER_ID 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    --and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                     and nvl(FACTORYDELIVERYDATE,p_to_date) between p_from_date and p_to_date 
                    AND m.APPLYFORSUBSIDYDATE IS NULL  
                    and FACTORYDELIVERYDATE is not null 
                     ORDER BY m.FACTORYDELIVERYDATE DESC 
                     
                    ) 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	v_usd      := v_usd+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_usd_g    := v_usd_g+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_bdt      := v_bdt+nvl(i.REALIZATIONAMOUNTBDT,0); 
        	v_bdt_g    := v_bdt_g+nvl(i.REALIZATIONAMOUNTBDT,0); 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.FACTORYDELIVERYDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
               <td style="text-align: left">'||HTF.escape_sc (i.SHORT_NAME) 
                ||'</td> 
               <td style="text-align: left">'|| HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,99,999')) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.DOCUMENTSUBMISSIONTOBANKDATE,'DD-MM-YY')) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.PAYMENTRECEIVEDDATE,'dd-mm-yy')) 
               ||'</td> 
               <td style="text-align: RIGHT">'||HTF.escape_sc (i.REALIZATIONAMOUNTUSD) 
               ||'</td> 
               <td style="text-align: RIGHT">'|| HTF.escape_sc (i.REALIZATIONAMOUNTBDT) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.APPLYFORPRCDATE,'dd-mm-yy')) 
               ||'</td> 
                <tr>'); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="7" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'||HTF.escape_sc (to_char(v_exp)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td  style="text-align: right;" ><b>'||HTF.escape_sc (to_char(v_usd)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="13" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="4" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'||HTF.escape_sc (v_exp_g) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (to_char(v_usd_g)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt_g)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
         
	END; 

--****************************

 procedure FACTORY_DELIVERY_DONE_BUYER_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number  := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' EXPORT STATEMENT FACTORY DELIVERY DONE - BUYER WISE '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size: 11px;"><tr> 
			<th style="width:1%" >SL.</th> 
			<th style="width:3%">Factory <br>Delivery<br> Date</th> 
			<th style="width:5%">Exp No</th>  
			<th style="width:4%">EXP ISSUE<br> DATE</th> 
			<th style="width:15%">Purchase Contact No</th> 
            <th style="width:10%">Comercial Invoice No</th> 
			<th style="width:5%">Comercial <br>Invoice Date</th> 
            <th style="width:4%">Bank</th> 
			<th style="width:3%">Value USD</th>  
            <th style="width:5%">Item</th> 
			<th style="width:3%">MT</th> 
           
			</tr>'); 
			 
		FOR r in (SELECT SHORT_NAME, BUYER_NAME, BUYER_ID  
                    FROM ERP_BUYER_INFO 
                    where BUYER_ID = nvl(p_buyer_name,BUYER_ID) 
                     AND org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
					and m.COMPANYID = nvl(p_company_name,m.COMPANYID)					 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and d.BUYER_ID = r.BUYER_ID 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    --and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    and nvl(FACTORYDELIVERYDATE,p_to_date) between p_from_date and p_to_date 
                    and( m.FACTORYDELIVERYDATE is not null 
                    or m.EXPDONE = upper('YES')) 
                   ; 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="11"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.BUYER_NAME) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
         for i in (select 	 m.FACTORYDELIVERYDATE 
                    		,m.EXPFORMNO 
                    		,m.EXPFORMDATE 
                    		,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
                    		,b.SHORT_NAME 
                    		,d.ITEM_NAME 
                    		,m.COMMERCIALINVOICEDATE 
                    		,d.VALUE_USD 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                    		,m.PAYMENTRECEIVEDDATE 
                    		,nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                    		,nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT 
                    		,d.QTY 
                   FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
					and m.COMPANYID = nvl(p_company_name,m.COMPANYID)					 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and d.BUYER_ID = r.BUYER_ID 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    --and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    and nvl(FACTORYDELIVERYDATE,p_to_date) between p_from_date and p_to_date 
                    and( m.FACTORYDELIVERYDATE is not null 
                    or m.EXPDONE = upper('YES')) 
                     ORDER BY m.FACTORYDELIVERYDATE DESC 
                   ) 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	v_usd      := v_usd+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_usd_g    := v_usd_g+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_bdt      := v_bdt+nvl(i.REALIZATIONAMOUNTBDT,0); 
        	v_bdt_g    := v_bdt_g+nvl(i.REALIZATIONAMOUNTBDT,0); 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.FACTORYDELIVERYDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.EXPFORMDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
               <td>'||HTF.escape_sc (to_char(i.COMMERCIALINVOICEDATE,'DD-MM-YY')) 
               ||'</td> 
               <td style="text-align: left;font-size: 10px;">'||HTF.escape_sc (i.SHORT_NAME) 
                ||'</td> 
               <td>'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,99,999')) 
               ||'</td> 
               <td style="text-align: left">'|| HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
                <tr>'); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="8" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'||HTF.escape_sc (to_char(v_exp)) 
               ||'</b></td> 
               <td></td> 
               <td><b>'|| HTF.escape_sc (to_char(v_qty,'99,99,999')) 
               ||'</b></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="11" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="5" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'||HTF.escape_sc (v_exp_g) 
               ||'</b></td> 
               <td></td> 
               <td><b>'|| HTF.escape_sc (TO_CHAR(v_qty_g,'99,99,999')) 
               ||'</b></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
         
	END;
 
--*****************************
 
 procedure SUBSIDY_AMOUNT_RECEIVE_BUYER_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count     number  := 0; 
	v_tax       number     := 0; 
	v_tax_g     number     := 0; 
	v_charge    number     := 0; 
	v_charge_g  number     := 0; 
	v_file      number     := 0; 
	v_file_g    number     := 0; 
	v_crg       number     := 0; 
	v_crg_g     number     := 0; 
	v_prc       number     := 0; 
	v_prc_g     number     := 0; 
	v_net       number     := 0; 
 
	v_net_g     number     := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' EXPORT STATEMENT SUBSIDY AMOUNT RECEIVE '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size: 10px;"><tr> 
			<th style="width:1%" >SL.</th> 
			<th style="width:5%">Exp No</th> 
            <th style="width:19%">Purchase Contact No</th> 
            <th style="width:9%">Bank</th> 
            <th style="width:7%">Item</th>	 
			<th style="width:2%">Quantity<br>(MT/BALE)</th> 
			<th style="width:3%">Export Value USD</th>  
			<th style="width:5%">Document Submit Date</th> 
            <th style="width:5%">SUBSIDY APPLY DATE</th> 
            <th style="width:4%">SUBSIDY PAYMENT REALISATION DATE</th> 
            <th style="width:2%">SUBSIDY RECEIVED BDT</th>  
            <th style="width:2%">SOURCE E TAX</th>			 
			<th style="width:2%">VAT ON PRC CHARGE</th> 
            <th style="width:2%">SUBSIDY FILE CRG.</th> 
            <th style="width:2%">VAT ON FILE CRG</th>			 
			<th style="width:2%">PRC CHARGE</th>			 
			<th style="width:2%">NET SUBSIDY AMOUNT RECEIVED</th> 
 
			</tr>'); 
			 
		FOR r in (SELECT SHORT_NAME ,BUYER_NAME, BUYER_ID  
                    FROM ERP_BUYER_INFO 
                    where BUYER_ID = nvl(p_buyer_name,BUYER_ID) 
                    AND org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
					and m.COMPANYID = nvl(p_company_name,m.COMPANYID) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and d.BUYER_ID = r.BUYER_ID 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    and nvl(REALIZATIONSUBSIDYDATE,p_to_date) between p_from_date and p_to_date 
                    AND M.REALIZATIONDATE IS NOT NULL 
                    and FACTORYDELIVERYDATE is not null 
                    ; 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="12"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.BUYER_NAME) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
            v_tax      := 0; 
            v_file     := 0; 
            v_charge   := 0; 
            v_crg      := 0; 
            v_prc      := 0; 
            v_net      := 0; 
         for i in (select 	m.EXPFORMNO 
							,d.PC_CONTRACT_NO 
                    		,b.SHORT_NAME 
							,d.ITEM_NAME 
                    		,d.QTY 
                    		,d.VALUE_USD 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
							,M.APPLYFORSUBSIDYDATE 
							,M.REALIZATIONSUBSIDYDATE 
							,M.REALIZATIONSUBSIDYBDT 
							,M.SOURCETAX 
							,M.VATONPRC 
							,M.CASHSUBSIDYFILECHARGE 
							,M.VATONFILECHARGE 
							,M.PRCCHARGE 
                            ,nvl(m.REALIZATIONSUBSIDYBDT,0)-(nvl(M.SOURCETAX,0)+nvl(M.VATONPRC,0)+nvl(M.CASHSUBSIDYFILECHARGE,0)+nvl(M.VATONFILECHARGE,0)+nvl(M.PRCCHARGE,0)) NET 
                   FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
					and m.COMPANYID = nvl(p_company_name,m.COMPANYID) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and d.BUYER_ID = r.BUYER_ID 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    and nvl(REALIZATIONSUBSIDYDATE,p_to_date) between p_from_date and p_to_date 
                    AND M.REALIZATIONDATE IS NOT NULL 
                    and FACTORYDELIVERYDATE is not null 
                    ) 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	-- v_usd      := v_usd+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	-- v_usd_g    := v_usd_g+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_bdt      := v_bdt+nvl(i.REALIZATIONSUBSIDYBDT,0); 
        	v_bdt_g    := v_bdt_g+nvl(i.REALIZATIONSUBSIDYBDT,0); 
        	v_tax       := v_tax     +nvl(i.SOURCETAX,0); 
        	v_tax_g     := v_tax_g   +nvl(i.SOURCETAX,0); 
        	v_charge    := v_charge  +nvl(i.VATONPRC,0); 
        	v_charge_g  := v_charge_g+nvl(i.VATONPRC,0); 
        	v_file      := v_file    +nvl(i.CASHSUBSIDYFILECHARGE,0); 
        	v_file_g    := v_file_g  +nvl(i.CASHSUBSIDYFILECHARGE,0); 
        	v_crg       := v_crg     +nvl(i.VATONFILECHARGE,0); 
        	v_crg_g     := v_crg_g   +nvl(i.VATONFILECHARGE,0); 
        	v_prc       := v_prc     +nvl(i.PRCCHARGE,0); 
        	v_prc_g     := v_prc_g   +nvl(i.PRCCHARGE,0); 
        	v_net       := v_net     +nvl(i.NET,0); 
        	v_net_g     := v_net_g   +nvl(i.NET,0); 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.SHORT_NAME) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.ITEM_NAME) 
               || '</td> 
               <td style="text-align: center">'||HTF.escape_sc (i.QTY) 
                ||'</td> 
               <td style="text-align: right">'|| HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.DOCUMENTSUBMISSIONTOBANKDATE,'DD-MM-YY')) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.APPLYFORSUBSIDYDATE,'DD-MM-YY')) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.REALIZATIONSUBSIDYDATE,'DD-MM-YY')) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.REALIZATIONSUBSIDYBDT) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.SOURCETAX) 
               ||'</td> 
               <td>'|| HTF.escape_sc (i.VATONPRC) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.CASHSUBSIDYFILECHARGE) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.VATONFILECHARGE) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.PRCCHARGE) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.NET) 
               ||'</td> 
                <tr>'); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="5" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'|| HTF.escape_sc (to_char(v_qty,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_exp)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_tax)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_charge,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_file,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_crg,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_prc,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_net,'99,99,99,99,999')) 
               ||'</b></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="17" style="text-align: right;">.</td><tr> 
               <td colspan="2"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="3" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'|| HTF.escape_sc (TO_CHAR(v_qty_g,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (v_exp_g) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt_g)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (v_tax_g) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (v_charge_g) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (v_file_g) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (v_crg_g) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (v_prc_g) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (v_net_g) 
               ||'</b></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
         
	END; 

--****************************
 
 procedure SUBSIDY_AMOUNT_DUE_BUYER_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number  := 0; 
    v_p_rcv_tot number := 0; 
    v_p_rcv_tot_g number := 0 ; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' EXPORT STATEMENT SUBSIDY AMOUNT DUE - BUYER WISE '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size:11px;"><tr> 
			<th style="width:1%" >SL.</th> 
			<th style="width:5%">Exp No</th> 
            <th style="width:17%">Purchase Contact No</th> 
			<th style="width:5%">EXP ISSUE<br> DATE</th> 
			<th style="width:10%">Commercial Invoice No</th> 
            <th style="width:7%">Bank</th> 
            <th style="width:6%">Items</th>	 
			<th style="width:3%">QUANTITY<br>(MT/BALE)</th>  
			<th style="width:6%">Document Submit Date</th> 
            <th style="width:4%">EXPORT VALUE USD</th> 
            <th style="width:4%">SUBSIDY RECEIVED BDT</th>  
            <th style="width:6%">PRC Apply Date</th>			 
			<th style="width:5%">SUBSIDY APPLY DATE</th> 
 
			</tr>'); 
			 
		FOR r in (SELECT SHORT_NAME ,BUYER_NAME, BUYER_ID  
                    FROM ERP_BUYER_INFO 
                    where BUYER_ID = nvl(p_buyer_name,BUYER_ID) 
                    AND org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
					and m.COMPANYID = nvl(p_company_name,m.COMPANYID) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and d.BUYER_ID = r.BUYER_ID 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    --and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    and nvl(FACTORYDELIVERYDATE,p_to_date) between p_from_date and p_to_date 
                    and (m.REALIZATIONSUBSIDYBDT is null 
                    or m.REALIZATIONSUBSIDYDATE is null) 
                    and  m.APPLYFORSUBSIDYDATE is not null 
                    and FACTORYDELIVERYDATE is not null 
                    ; 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="12"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.BUYER_NAME) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
            v_p_rcv_tot := 0; 
         for i in (select 	 m.FACTORYDELIVERYDATE 
                    		,m.EXPFORMNO 
                    		,m.EXPFORMDATE 
                    		,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
                    		,b.SHORT_NAME 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                    		,d.VALUE_USD 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                    		,m.PAYMENTRECEIVEDDATE 
                    		,nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                    		,nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT 
                    		,m.EXPDONE, 
                            m.PAYMENTRECEIVEDBDT 
                            ,m.APPLYFORPRCDATE 
                            ,m.APPLYFORSUBSIDYDATE 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
					and m.COMPANYID = nvl(p_company_name,m.COMPANYID) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and d.BUYER_ID = r.BUYER_ID 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    --and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    and nvl(FACTORYDELIVERYDATE,p_to_date) between p_from_date and p_to_date 
                    and (m.REALIZATIONSUBSIDYBDT is null 
                    or m.REALIZATIONSUBSIDYDATE is null) 
                    and  m.APPLYFORSUBSIDYDATE is not null 
                    and FACTORYDELIVERYDATE is not null 
                     ORDER BY m.FACTORYDELIVERYDATE DESC 
                    ) 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	v_usd      := v_usd+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_usd_g    := v_usd_g+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_bdt      := v_bdt+nvl(i.REALIZATIONAMOUNTBDT,0); 
        	v_bdt_g    := v_bdt_g+nvl(i.REALIZATIONAMOUNTBDT,0); 
            v_p_rcv_tot:= v_p_rcv_tot + nvl(i.PAYMENTRECEIVEDBDT,0); 
            v_p_rcv_tot_g:= v_p_rcv_tot_g + nvl(i.PAYMENTRECEIVEDBDT,0); 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (TO_CHAR(i.EXPFORMDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
               <td style="text-align: left">'||HTF.escape_sc (i.SHORT_NAME) 
                ||'</td> 
               <td style="text-align: left;font-size:10px;">'|| HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.DOCUMENTSUBMISSIONTOBANKDATE,'DD-MM-YY')) 
               ||'</td> 
               <td>'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.PAYMENTRECEIVEDBDT) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.APPLYFORPRCDATE,'dd-mm-yy')) 
               ||'</td> 
               <td>'|| HTF.escape_sc (TO_CHAR(i.APPLYFORSUBSIDYDATE,'DD-MM-YY')) 
               ||'</td> 
                <tr>'); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="9" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'||HTF.escape_sc (to_char(v_exp)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_p_rcv_tot)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="13" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="6" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'||HTF.escape_sc (v_exp_g) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_p_rcv_tot_g)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
         
	END; 

--**************************** 
 
 procedure AUDIT_CERTIFICATE_RECEIVED (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number  := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' AUDIT CERTIFICATE RECIEVED DATE '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size:11px;"><tr> 
			<th style="width:1%" >SL.</th> 
			<th style="width:6%">Factory Delivery<br> Date</th> 
			<th style="width:10%">Exp No</th> 
			<th style="width:5%">EXP ISSUE<br> DATE</th> 
			<th style="width:14%">Purchase Contract No</th> 
			<th style="width:12%">Commercial Invoice No</th> 
			<th style="width:6%">Bank</th> 
            <th style="width:7%">Item</th> 
			<th style="width:2%">Quantity<br>(MT/Bale)</th> 
			<th style="width:2%">Export Value USD</th> 	 
			<th style="width:3%">Document Submit Date</th> 
            <th style="width:3%">Payment Realisation Date</th>	 
			<th style="width:5%">SUBSIDY APPLY DATE</th>
            <th style="width:3%">Audit Certificate Recieved Date</th>				 
 
			</tr>'); 
			 
		FOR r in (SELECT SHORT_NAME BANK_NAME,BANK_ID 
					FROM ERP_BANK_INFO 
					WHERE BANK_ID=NVL(p_bank_name,BANK_ID) 
                    and org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
					and m.COMPANYID =NVL(p_company_name, m.COMPANYID) 
                    and nvl(m.BANK,0) = NVL(R.BANK_ID,0) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and FACTORYDELIVERYDATE is not null
                    -- and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    and nvl(AUDITCERTIFICATERECEIVEDDATE,p_to_date) between p_from_date and p_to_date
                    and m.AUDITCERTIFICATERECEIVEDDATE is not null
                   and m.REALIZATIONDATE is null; 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="12"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.BANK_NAME) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
         for i in (select 	 m.FACTORYDELIVERYDATE 
                    		,m.EXPFORMNO 
                    		,m.EXPFORMDATE 
                    		,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
                    		,b.SHORT_NAME 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                    		,d.VALUE_USD 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                    		,m.PAYMENTRECEIVEDDATE 
                    		,nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                    		,nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT 
                    		,m.AUDITCERTIFICATERECEIVEDDATE 
                            ,m.APPLYFORSUBSIDYDATE 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
					and m.COMPANYID =NVL(p_company_name, m.COMPANYID) 
                    and nvl(m.BANK,0) = NVL(R.BANK_ID,0) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0))
                    and FACTORYDELIVERYDATE is not null 
                    -- and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    and nvl(AUDITCERTIFICATERECEIVEDDATE,p_to_date) between p_from_date and p_to_date
                   and m.AUDITCERTIFICATERECEIVEDDATE is not null
                   and m.REALIZATIONDATE is null
                     ORDER BY m.AUDITCERTIFICATERECEIVEDDATE asc) 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	v_usd      := v_usd+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_usd_g    := v_usd_g+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_bdt      := v_bdt+nvl(i.REALIZATIONAMOUNTBDT,0); 
        	v_bdt_g    := v_bdt_g+nvl(i.REALIZATIONAMOUNTBDT,0); 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.FACTORYDELIVERYDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align:LEFT">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: CENTER">' 
               || HTF.escape_sc (TO_CHAR(i.EXPFORMDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
               <td style="text-align: left;font-size:10px;">'||HTF.escape_sc (i.SHORT_NAME) 
                ||'</td> 
               <td style="text-align: left">'|| HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
               <td style="text-align: RIGHT">'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.DOCUMENTSUBMISSIONTOBANKDATE,'DD-MM-YY')) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.PAYMENTRECEIVEDDATE,'dd-mm-yy')) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.APPLYFORSUBSIDYDATE,'DD-MM-YY')) 
               ||'</td>
               <td>'||HTF.escape_sc (to_char(i.AUDITCERTIFICATERECEIVEDDATE,'dd-mm-yy')) 
               ||'</td> 
                <tr>'); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="8" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'|| HTF.escape_sc (to_char(v_qty,'99,99,999')) 
               ||'</b></td> 
               <td style="text-align: RIGHT"><b>'||HTF.escape_sc (to_char(v_exp)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td></td> 
               <td></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="13" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="5" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'|| HTF.escape_sc (TO_CHAR(v_qty_g,'99,99,999')) 
               ||'</b></td> 
               <td style="text-align: RIGHT"><b>'||HTF.escape_sc (to_char(v_exp_g)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td></td> 
               <td></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
        
	END;
 
--*****************************
 
 procedure SUBSIDY_AMOUNT_DUE_BANK_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number  := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' EXPORT STATEMENT SUBSIDY AMOUNT DUE - BANK WISE '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size:10px;"><tr> 
			<th style="width:1%" >SL.</th> 
			<th style="width:15%">Exp No</th> 
			<th style="width:12%">Purchase Contract No</th> 
			<th style="width:4%">EXP ISSUE<br> DATE</th> 
			<th style="width:10%">Commercial Invoice No</th> 
			<th style="width:6%">Bank</th> 
            <th style="width:7%">Items</th> 
			<th style="width:3%">Quantity<br>(MT/Bale)</th> 
            <th style="width:5%">DOCUMENT SUBMIT DATE</th>	 
			<th style="width:4%">Export Value USD</th>  
			<th style="width:3%">SUBSIDY RECEIVED BDT</th> 
            <th style="width:6%">PRC Apply Date</th> 
            <th style="width:5%">Subsidy Apply Date</th> 		 
 
			</tr>'); 
			 
		FOR r in (SELECT SHORT_NAME BANK_NAME,BANK_ID 
					FROM ERP_BANK_INFO 
					WHERE BANK_ID=NVL(p_bank_name,BANK_ID) 
                    and org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
					and m.COMPANYID =NVL(p_company_name, m.COMPANYID) 
                    and nvl(m.BANK,0) = NVL(R.BANK_ID,0) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and FACTORYDELIVERYDATE is not null
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date; 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="13"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.BANK_NAME) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
         for i in (select 	 m.FACTORYDELIVERYDATE 
                    		,m.EXPFORMNO 
                    		,m.EXPFORMDATE 
                    		,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
                    		,b.SHORT_NAME 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                    		,d.VALUE_USD 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                    		,m.PAYMENTRECEIVEDDATE 
                    		,nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                    		,nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT 
                    		,m.APPLYFORSUBSIDYDATE 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
					and m.COMPANYID =NVL(p_company_name, m.COMPANYID) 
                    and nvl(m.BANK,0) = NVL(R.BANK_ID,0) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    and FACTORYDELIVERYDATE is not null
                     ORDER BY m.FACTORYDELIVERYDATE DESC) 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	v_usd      := v_usd+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_usd_g    := v_usd_g+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_bdt      := v_bdt+nvl(i.REALIZATIONAMOUNTBDT,0); 
        	v_bdt_g    := v_bdt_g+nvl(i.REALIZATIONAMOUNTBDT,0); 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
               <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
               <td style="text-align: left">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: CENTER">' 
               || HTF.escape_sc (TO_CHAR(i.EXPFORMDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
               <td style="text-align: left">'||HTF.escape_sc (i.SHORT_NAME) 
                ||'</td> 
               <td style="text-align: left">'|| HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.DOCUMENTSUBMISSIONTOBANKDATE,'DD-MM-YY')) 
               ||'</td> 
               <td style="text-align: RIGHT">'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td style="text-align: RIGHT">'|| HTF.escape_sc (i.REALIZATIONAMOUNTBDT) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.PAYMENTRECEIVEDDATE,'dd-mm-yy')) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.APPLYFORSUBSIDYDATE,'DD-MM-YY')) 
               ||'</td> 
                <tr>'); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="7" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'|| HTF.escape_sc (to_char(v_qty,'99,99,999')) 
               ||'</b></td> 
               <td></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (to_char(v_exp)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="13" style="text-align: right;">.</td><tr> 
               <td colspan="2"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="5" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'|| HTF.escape_sc (TO_CHAR(v_qty_g,'99,99,999')) 
               ||'</b></td> 
               <td></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (to_char(v_exp_g)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt_g)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
         
	END;
 
--********************************
 
     procedure ALL_EXPORT_BANK_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number  	:= 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' ALL EXPORT BANK STATEMENT '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size:11px;"><tr> 
			<th style="width:1%" >SL.</th> 
			<th style="width:5%">Factory Delivery Date</th> 
            <th style="width:15%">Exp No</th> 
			<th style="width:5%">EXP ISSUE<br> DATE</th> 
			<th style="width:16%">Purchase Contract No</th> 
			<th style="width:10%">Commercial Invoice No</th> 
			<th style="width:7%">Bank</th> 
            <th style="width:7%">Item</th> 
			<th style="width:2%">Quantity<br>(MT/Bale</th> 
            <th style="width:5%">Export Value USD</th>	 
			<th style="width:6%">Document Submit Date</th>  
			<th style="width:3%">Payment Realisation Date</th> 
            <th style="width:4%">Amount Realise Usd</th> 
            <th style="width:4%">Amount Realise Usd</th> 
            <th style="width:3%">Expo Done</th>			 
 
			</tr>'); 
			 
		FOR r in (SELECT SHORT_NAME BANK_NAME,BANK_ID 
					FROM ERP_BANK_INFO 
					WHERE BANK_ID=NVL(p_bank_name,BANK_ID) 
                    and org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
					and m.COMPANYID =NVL(p_company_name, m.COMPANYID) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = NVL(R.BANK_ID,0) 
                    and FACTORYDELIVERYDATE is not null
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    ; 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="12"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.BANK_NAME) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
         for i in (select 	 m.FACTORYDELIVERYDATE 
                    		,m.EXPFORMNO 
                    		,m.EXPFORMDATE 
                    		,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
                    		,b.SHORT_NAME 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                    		,d.VALUE_USD 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                    		,m.PAYMENTRECEIVEDDATE 
                    		,nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                    		,nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT 
                    		,m.EXPDONE 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = R.BANK_ID 
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    and FACTORYDELIVERYDATE is not null
                    and m.COMPANYID =NVL(p_company_name, m.COMPANYID) 
                     ORDER BY m.FACTORYDELIVERYDATE DESC) 
					 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	v_usd      := v_usd+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_usd_g    := v_usd_g+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_bdt      := v_bdt+nvl(i.REALIZATIONAMOUNTBDT,0); 
        	v_bdt_g    := v_bdt_g+nvl(i.REALIZATIONAMOUNTBDT,0); 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.FACTORYDELIVERYDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (TO_CHAR(i.EXPFORMDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: left;font-size:10px;">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
               <td style="text-align: left;font-size:10px;">'||HTF.escape_sc (i.SHORT_NAME) 
                ||'</td> 
               <td style="text-align: left">'|| HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
               <td>'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.DOCUMENTSUBMISSIONTOBANKDATE,'DD-MM-YY')) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.PAYMENTRECEIVEDDATE,'dd-mm-yy')) 
               ||'</td> 
               <td style="text-align: RIGHT">'||HTF.escape_sc (i.REALIZATIONAMOUNTUSD) 
               ||'</td> 
               <td style="text-align: RIGHT">'|| HTF.escape_sc (i.REALIZATIONAMOUNTBDT) 
               ||'</td> 
               <td '||case when i.EXPDONE = 'CANCEL' then 'bgcolor= "yellow"' end ||'>'||HTF.escape_sc (i.EXPDONE) 
               ||'</td> 
                <tr>'); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="8" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'|| HTF.escape_sc (to_char(v_qty,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_exp)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td  style="text-align: right;" ><b>'||HTF.escape_sc (to_char(v_usd)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="15" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="5" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'|| HTF.escape_sc (TO_CHAR(v_qty_g,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (v_exp_g) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (to_char(v_usd_g)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt_g)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
       
	END;
 
--*********************************
 
 procedure EXPORT_PAYMENT_DUE_BANK_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number  := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' EXPORT PAYMENT REALISATION DUE BANK WISE '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size:10px;"><tr> 
			<th style="width:1%" >SL.</th> 
			<th style="width:4%">Factory Delivery Date</th> 
            <th style="width:10%">Exp No</th> 
			<th style="width:5%">EXP ISSUE<br> DATE</th> 
			<th style="width:12%">Purchase Contract No</th> 
			<th style="width:10%">Commercial Invoice No</th> 
			<th style="width:7%">Bank</th> 
            <th style="width:7%">Item</th> 
			<th style="width:2%">Quantity<br>(MT/Bale)</th> 
            <th style="width:5%">Export Value USD</th>	 
			<th style="width:5%">Document Submit Date</th>  
			<th style="width:3%">Payment Realisation Date</th> 
            <th style="width:4%">Amount Realise Usd</th> 
            <th style="width:4%">Amount Realise BDT</th>  
            <th style="width:2%">Expo Done</th>			 
 
			</tr>'); 
			 
		FOR r in (SELECT SHORT_NAME BANK_NAME,BANK_ID 
					FROM ERP_BANK_INFO 
					WHERE BANK_ID=NVL(p_bank_name,BANK_ID) 
                    and org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
					and m.COMPANYID =NVL(p_company_name, m.COMPANYID) 
                    and nvl(m.BANK,0) = NVL(R.BANK_ID,0) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and FACTORYDELIVERYDATE is not null
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date; 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="12"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.BANK_NAME) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
         for i in (select 	 m.FACTORYDELIVERYDATE 
                    		,m.EXPFORMNO 
                    		,m.EXPFORMDATE 
                    		,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
                    		,b.SHORT_NAME 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                    		,d.VALUE_USD 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                    		,m.PAYMENTRECEIVEDDATE 
                    		,nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                    		,nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT 
                    		,m.EXPDONE 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
					and m.COMPANYID =NVL(p_company_name, m.COMPANYID) 
                    and nvl(m.BANK,0) = NVL(R.BANK_ID,0) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date
                    and FACTORYDELIVERYDATE is not null 
                     ORDER BY m.FACTORYDELIVERYDATE DESC) 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	v_usd      := v_usd+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_usd_g    := v_usd_g+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_bdt      := v_bdt+nvl(i.REALIZATIONAMOUNTBDT,0); 
        	v_bdt_g    := v_bdt_g+nvl(i.REALIZATIONAMOUNTBDT,0); 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.FACTORYDELIVERYDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.EXPFORMDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: left;font-size:10px;">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
               <td style="text-align: left">'||HTF.escape_sc (i.SHORT_NAME) 
                ||'</td> 
               <td style="text-align: left;font-size:10px;">'|| HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
               <td style="text-align: RIGHT">'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.DOCUMENTSUBMISSIONTOBANKDATE,'DD-MM-YY')) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.PAYMENTRECEIVEDDATE,'dd-mm-yy')) 
               ||'</td> 
               <td style="text-align: RIGHT">'||HTF.escape_sc (i.REALIZATIONAMOUNTUSD) 
               ||'</td> 
               <td style="text-align: RIGHT">'|| HTF.escape_sc (i.REALIZATIONAMOUNTBDT) 
               ||'</td> 
               <td '||case when i.EXPDONE = 'CANCEL' then 'bgcolor= "yellow"' end ||'>'||HTF.escape_sc (i.EXPDONE) 
               ||'</td> 
                <tr>'); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="8" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'|| HTF.escape_sc (to_char(v_qty,'99,99,999')) 
               ||'</b></td> 
               <td style="text-align: RIGHT"><b>'||HTF.escape_sc (to_char(v_exp)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td  style="text-align: right;" ><b>'||HTF.escape_sc (to_char(v_usd)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="15" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="5" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'|| HTF.escape_sc (TO_CHAR(v_qty_g,'99,99,999')) 
               ||'</b></td> 
               <td style="text-align: RIGHT"><b>'||HTF.escape_sc (to_char(v_exp_g)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td style="text-align: RIGHT"><b>'||HTF.escape_sc (to_char(v_usd_g)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt_g)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
          
	END;
 
--***************************
 
procedure Subsidy_amount_Receive (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
	v_etax	 number 	:= 0; 
	v_etax_g number		:= 0; 
	v_vat_p	number		:= 0; 
	v_vat_g	number		:= 0; 
	v_CRG	number		:= 0; 
	v_CRG_G	number		:= 0; 
	v_ON_CRG number		:= 0; 
	v_ON_CRG_G number	:= 0; 
	v_prc    number		:= 0; 
	v_prc_g		number	:= 0; 
	v_amount   number	:= 0; 
	v_net_amount number	:= 0;	 
    v_count number  	:= 0; 
    v_sl_g  number      := 0; 
    v_net_amount_g  number := 0; 
    v_sub_rc_amt    number := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, 'Subsidy Amount Receive'); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size:11px;"><tr>
			<th style="width:1%" >SL.</th>
			<th style="width:6%">Factory Delivery Date</th>  
			<th style="width:4%">Exp No</th>  
			<th style="width:22%">Commercial Invoice No</th> 
			<th style="width:16%">Bank</th> 
			<th style="width:18%">Items</th> 
			<th style="width:2%">Export Value USD</th>  
			<th style="width:7%">Subsidy Apply Date</th> 
			<th style="width:2%">Subsidy Payment Realisation Date</th> 
			<th style="width:1%">Subsidy Received DBT</th> 
			<th style="width:1%">Source E Tax</th> 
			<th style="width:2%">Subsidy File CRG.</th> 
			<th style="width:2%">VAT On File CRG.</th> 
			<th style="width:2%">PRC Charge</th> 
			<th style="width:2%">VAT On <br>PRC Charge</th> 
			<th style="width:2%">Net Subsidy Amount Received</th> 
			 
 
 
             
			</tr>'); 
			 
		FOR r in (SELECT CODE, CODE_DESC  
                    FROM G_UNI_CODES  
                    WHERE P_CODE =APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')||'0001' 
                    and CODE = nvl(p_company_name,code)  
                    and org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    ORDER BY CODE) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and REALIZATIONDATE between p_from_date and p_to_date 
                    AND m.APPLYFORSUBSIDYDATE IS NOT NULL 
                    AND m.PAYMENTRECEIVEDDATE IS NOT NULL 
                    AND M.REALIZATIONDATE IS NOT NULL 
                    -- AND M.REALIZATIONSUBSIDYBDT IS NOT NULL 
                    -- AND nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD IS NOT NULL 
                    -- AND M.SOURCETAX IS NOT NULL 
                    -- AND M.PRCCHARGE IS NOT NULL 
                    -- AND M.CASHSUBSIDYFILECHARGE IS NOT NULL 
                    -- AND M.VATONFILECHARGE IS NOT NULL 
                    -- AND M.VATONPRC IS NOT NULL 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID) 
                    ; 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="17"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.CODE_DESC) 
               || '</b></td> 
                <tr>'); 
end if;                 
           	v_sl            := 0; 
        	v_qty           := 0; 
        	v_usd           := 0; 
        	v_bdt           := 0; 
        	v_etax	  	:= 0; 
        	v_vat_p	        := 0; 
        	v_CRG	        := 0; 
        	v_ON_CRG 	:= 0; 
        	v_prc           := 0; 
        	v_amount  	:= 0; 
        	v_net_amount 	:= 0; 
            v_sub_rc_amt        := 0; 
 
         for i in (select 	m.EXPFORMNO 
				,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
                    		,b.SHORT_NAME 
				,d.ITEM_NAME 
                    		,d.QTY 
                    		,d.VALUE_USD 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                               ,m.FACTORYDELIVERYDATE 
			       ,M.APPLYFORSUBSIDYDATE 
				,M.REALIZATIONSUBSIDYDATE 
				,M.REALIZATIONSUBSIDYBDT 
				,M.SOURCETAX 
				,M.VATONPRC 
				,M.CASHSUBSIDYFILECHARGE 
				,M.VATONFILECHARGE 
				,M.PRCCHARGE 
                            , m.REALIZATIONDATE 
                            , nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and REALIZATIONDATE between p_from_date and p_to_date 
                    AND m.APPLYFORSUBSIDYDATE IS NOT NULL 
                    AND M.REALIZATIONDATE IS NOT NULL 
                    AND (m.PAYMENTRECEIVEDDATE IS NOT NULL or m.AUDITCERTIFICATERECEIVEDDATE is not null) 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID)) 
                    loop 
            v_sl 	   := v_sl+1; 
            v_sl_g 	   := v_sl_g+1; 
         	v_qty       := v_qty +nvl(i.QTY,0); 
			v_qty_g     :=v_qty_g +nvl(i.QTY,0) ; 
			v_usd       := v_usd + nvl(i.VALUE_USD,0); 
			v_usd_g     := v_usd_g + nvl(i.VALUE_USD,0); 
			v_bdt       := v_bdt + nvl(i.REALIZATIONSUBSIDYBDT,0); 
			v_bdt_g     := v_bdt_g + nvl(i.REALIZATIONSUBSIDYBDT,0); 
			v_etax		:= v_etax + nvl(i.SOURCETAX,0); 
			v_etax_g	:=v_etax_g + nvl(i.SOURCETAX,0) ; 
			v_vat_p		:= v_vat_p + nvl(i.VATONPRC,0); 
			v_vat_g		:= v_vat_g + nvl(i.VATONPRC,0); 
			v_CRG		:= v_CRG + nvl(i.CASHSUBSIDYFILECHARGE,0); 
			v_CRG_G		:= v_CRG_G + nvl(i.CASHSUBSIDYFILECHARGE,0); 
			v_ON_CRG	:= V_ON_CRG + nvl(i.VATONFILECHARGE,0); 
			v_ON_CRG_G	:= v_on_crg_g + nvl(i.VATONFILECHARGE,0); 
			v_prc   	:= v_prc +nvl(i.PRCCHARGE,0); 
			v_prc_g		:= v_prc_g + nvl(i.PRCCHARGE,0); 
			v_amount	:= nvl(i.REALIZATIONSUBSIDYBDT,0)-(nvl(i.SOURCETAX,0)+nvl(i.VATONPRC,0)+nvl(i.CASHSUBSIDYFILECHARGE,0)+nvl(i.VATONFILECHARGE,0)+nvl(i.PRCCHARGE,0)); 
			v_net_amount:= v_net_amount +nvl(v_amount,0); 
			v_net_amount_g := v_net_amount_g +nvl(v_amount,0); 
            v_sub_rc_amt := v_sub_rc_amt + nvl(i.REALIZATIONSUBSIDYBDT,0); 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td>  
               <td style="text-align: center">'|| HTF.escape_sc (TO_CHAR(i.FACTORYDELIVERYDATE,'DD-MM-YY')) 
               ||'</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.SHORT_NAME) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.ITEM_NAME) 
               || '</td> 
               <td style="text-align: RIGHT">'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
                ||'</td>
               <td>'||HTF.escape_sc (TO_CHAR(i.APPLYFORSUBSIDYDATE,'DD-MM-YY')) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.REALIZATIONDATE,'DD-MM-YY')) 
               ||'</td> 
               <td style="text-align: center">'||HTF.escape_sc (i.REALIZATIONSUBSIDYBDT) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.SOURCETAX) 
               ||'</td> 
               <td>'|| HTF.escape_sc (i.CASHSUBSIDYFILECHARGE) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.VATONFILECHARGE) 
               ||'</td> 
				 <td>'||HTF.escape_sc (i.PRCCHARGE) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.VATONPRC) 
               ||'</td> 
			   <td style="text-align: RIGHT">'||HTF.escape_sc (v_amount) 
               ||'</td> 
                <tr>'); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="6" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'||HTF.escape_sc (to_char(v_usd ,'99,99,999.00')) 
               ||'</b></td> 
               <td></td> 
			   <td>'||HTF.escape_sc (null) 
               ||'</td> 
               <td ><b>'||HTF.escape_sc (v_sub_rc_amt) 
               ||'</b></td> 
			   <td><b>'||HTF.escape_sc (v_etax) 
               ||'</b></td> 
			   <td><b>'||HTF.escape_sc (to_char(v_CRG,'99,99,999.00')) 
               ||'</b></td> 
			   <td><b>'||HTF.escape_sc (to_char(v_ON_CRG,'99,99,999.00')) 
               ||'</b></td> 
			   <td><b>'||HTF.escape_sc (to_char(v_prc,'99,99,999.00')) 
               ||'</b></td> 
			   <td><b>'||HTF.escape_sc (to_char(v_vat_p,'99,99,999.00')) 
               ||'</b></td> 
			   <td style="text-align: right;"><b>'||HTF.escape_sc (v_net_amount) 
               ||'</b></td> 
			 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="15" style="text-align: right;">.</td><tr> 
               <td colspan="2"><b>Total Retult : '||HTF.escape_sc (v_sl_g) 
               ||'</b></td> 
                <td colspan="4" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_usd_g)) 
               ||'</b></td> 
               <td></td> 
			   <td></td> 
               <td><b>'||HTF.escape_sc (v_bdt_g ) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (v_etax_g) 
               ||'</b></td> 
			   <td><b>'||HTF.escape_sc (v_CRG_G) 
               ||'</b></td> 
			   <td><b>'||HTF.escape_sc (v_ON_CRG_G) 
               ||'</b></td> 
			   <td><b>'||HTF.escape_sc (v_prc_g) 
               ||'</b></td> 
			   <td><b>'||HTF.escape_sc (v_vat_g) 
               ||'</b></td> 
			    <td style="text-align: right;"><b>'||HTF.escape_sc (v_net_amount_g) 
               ||'</b></td> 
			    
 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
          
	END; 

--**************************
 
	procedure Subsidy_amount_due_All_Export (p_company_name varchar2,P_buyer_name varchar2,P_item_name varchar2,P_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl    number      := 0; 
	v_tot_sl number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt_g  number     := 0; 
    v_exp    number     := 0; 
    v_exp_g  number     := 0; 
    v_count number      := 0; 
    v_result    number  := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, 'Subsidy amount due (All Export) '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size:11px;"><tr> 
			<th style="width:1%">Sl</th>  
			<th style="width:10%">Exp No</th>  
			<th style="width:12%">Purchase Contact No</th> 
			<th style="width:5%">Exp Issue<br>Date</th> 
            <th style="width:10%">Comercial Invoice No</th> 
            <th style="width:7%">Bank</th> 
            <th style="width:5%">Items</th> 
			<th style="width:2%"> Quantity<br>(MT/BALE)</th> 
			<th style="width:5%">Document Submit Date</th> 
			<th style="width:5%">Export Value USD</th> 
			<th style="width:3%">Subsidy Received DBT</th> 
			<th style="width:4%">PRC Apply Date</th> 
			<th style="width:5%">Subsidy Apply Date</th> 
             
			</tr>'); 
			 
		FOR r in (SELECT CODE, CODE_DESC  
                    FROM G_UNI_CODES  
                    WHERE P_CODE =APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')||'0001' 
                    and CODE = nvl(p_company_name,code)  
                    and org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    ORDER BY CODE) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                     and m.APPLYFORSUBSIDYDATE is null 
                     
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID); 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="13"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.CODE_DESC) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl        := 0; 
        	v_usd       := 0; 
            v_exp       := 0; 
        	-- v_exp_g     := 0; 
            -- v_result    := 0; 
        	 
        	 
         for i in (select 	 
                    		m.EXPFORMNO 
							,d.PC_CONTRACT_NO 
                    		,m.EXPFORMDATE 
                    		,m.COMMERCIALINVOICENO 
                    		,b.SHORT_NAME 
                    		,d.ITEM_NAME 
                    		,d.QTY 
							,m.DOCUMENTSUBMISSIONTOBANKDATE 
							,d.VALUE_USD 
                    		,M.REALIZATIONSUBSIDYBDT 
							,M.APPLYFORPRCDATE 
							,M.APPLYFORSUBSIDYDATE 
                    		 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(FACTORYDELIVERYDATE,p_to_date) between p_from_date and p_to_date 
                    and m.APPLYFORSUBSIDYDATE is null 
                     
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID)) 
                    loop 
            v_sl        := v_sl+1; 
        	v_exp       := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g     := v_exp_g+nvl(i.VALUE_USD,0); 
            v_result    :=v_result +1; 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.EXPFORMDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
			    <td style="text-align: left">' 
               || HTF.escape_sc (i.SHORT_NAME) 
               || '</td> 
                <td style="text-align: left;font-size:10px;">' 
               || HTF.escape_sc (i.ITEM_NAME) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (i.QTY) 
               || '</td> 
               <td style="text-align: center">'||HTF.escape_sc (TO_CHAR(i.DOCUMENTSUBMISSIONTOBANKDATE,'DD-MM-YY')) 
                ||'</td> 
				 <td style="text-align: right">'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td style="text-align: right">'|| HTF.escape_sc (i.REALIZATIONSUBSIDYBDT) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.APPLYFORPRCDATE,'dd-mm-yy')) 
               ||'</td> 
			    <td style="text-align: center">'|| HTF.escape_sc (TO_CHAR(i.APPLYFORSUBSIDYDATE,'DD-MM-YY')) 
               ||'</td>'); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="9" style="text-align: right;"><b>Total</b> :</td> 
 
               <td style="text-align: right;"><b>'||HTF.escape_sc (to_char(v_exp)) 
               ||'</b></td> 
                
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="16" style="text-align: right;">.</td><tr> 
                 <td colspan="3" style="text-align: right;"><b>Total Result :'||HTF.escape_sc (v_result) 
               ||'</b></td> 
            
                <td colspan="6" style="text-align: right;"><b>Grand Total :</b></td> 
 
               <td style="text-align: right;"><b>'||HTF.escape_sc (to_char(v_exp_g)) 
               ||'</b></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
         
	END; 

--****************************

	procedure Document_submit_done      (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
 
        is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
    v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number      := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' Document submit done '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size:11px;"><tr> 
			<th style="width:1%" >SL.</th> 
            <th style="width:4%">Factory Delivery<br> Date</th>
			<th style="width:5%">Exp No</th>
			<th style="width:16%">Purchase Contact No</th> 
			<th style="width:10%">Comercial Invoice No</th> 
			<th style="width:6%">Comercial <br>Invoice Date</th>   
			<th style="width:5%">EXP ISSUE<br> DATE</th>  
            <th style="width:8%">Bank</th> 
			<th style="width:2%"> Value USD</th> 
            <th style="width:7%">Items</th> 
			<th style="width:1%"> MT</th> 
			<th style="width:4%">Document Submit Date</th> 
			<th style="width:3%">Payment Received USD</th> 
			<th style="width:3%">Payment Received BDT</th> 
			<th style="width:5%">Payment Realized Date</th> 
			<th style="width:5%"> Apply for PRC Date</th> 
             
			</tr>'); 
			 
		FOR r in (SELECT CODE, CODE_DESC  
                    FROM G_UNI_CODES  
                    WHERE P_CODE =APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')||'0001' 
                    and CODE = nvl(p_company_name,code)  
                    and org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    ORDER BY CODE) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(DOCUMENTSUBMISSIONTOBANKDATE,p_to_date) between p_from_date and p_to_date 
                     and m.FACTORYDELIVERYDATE is not null 
                    and m.DOCUMENTSUBMISSIONTOBANKDATE is not null 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID); 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="16"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.CODE_DESC) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
            v_bdt      := 0; 
        	 
         for i in (select 	 
							m.PURCHASECONTACTID 
                    		,m.COMMERCIALINVOICENO 
                            ,m.COMMERCIALINVOICEDATE 
                            ,m.EXPFORMNO 
                            ,m.EXPFORMDATE 
                            ,m.FACTORYDELIVERYDATE 
                    		,b.SHORT_NAME 
                            ,d.VALUE_USD 
                    		,d.ITEM_NAME 
                    		,d.QTY 
							,m.DOCUMENTSUBMISSIONTOBANKDATE 
                            ,m.PAYMENTRECEIVEDUSD 
                            ,m.PAYMENTRECEIVEDBDT 
                            ,m.PAYMENTRECEIVEDDATE 
                            ,m.APPLYFORPRCDATE 
                            ,d.PC_CONTRACT_NO		 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(DOCUMENTSUBMISSIONTOBANKDATE,p_to_date) between p_from_date and p_to_date 
                    and m.FACTORYDELIVERYDATE is not null 
                    and m.DOCUMENTSUBMISSIONTOBANKDATE is not null 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID) 
                     ORDER BY m.FACTORYDELIVERYDATE DESC) 
                    loop 
            v_sl := v_sl+1; 
            v_tot_sl := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	v_usd      := v_usd+nvl(i.PAYMENTRECEIVEDUSD,0); 
        	v_usd_g    := v_usd_g+nvl(i.PAYMENTRECEIVEDUSD,0); 
        	v_bdt      := v_bdt+nvl(i.PAYMENTRECEIVEDBDT,0); 
        	v_bdt_g    := v_bdt_g+nvl(i.PAYMENTRECEIVEDBDT,0); 
        	 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
			    <td style="text-align: center;font-size:10px;">' 
               || HTF.escape_sc (TO_CHAR(i.FACTORYDELIVERYDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: left;font-size:10px;">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td>  
                <td style="text-align: left;font-size:10px;">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
                <td style="text-align: center;;font-size:10px;">' 
               || HTF.escape_sc (to_char(i.COMMERCIALINVOICEDATE,'dd-mm-yy')) 
               || '</td> 
                <td style="text-align: center;font-size:10px;">' 
               || HTF.escape_sc (TO_CHAR(i.EXPFORMDATE,'DD-MM-YY')) 
               || '</td>
               <td style="text-align: left;font-size:10px;">'||HTF.escape_sc (i.SHORT_NAME) 
                ||'</td> 
				 <td>'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td style="text-align: left;font-size:10px;">'|| HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
			    <td style="text-align: center;font-size:10px;">'|| HTF.escape_sc (TO_CHAR(i.DOCUMENTSUBMISSIONTOBANKDATE,'DD-MM-YY')) 
               ||'</td> 
			    <td style="text-align: right">'|| HTF.escape_sc (i.PAYMENTRECEIVEDUSD) 
               ||'</td> 
			     <td style="text-align: right">'|| HTF.escape_sc (i.PAYMENTRECEIVEDBDT) 
               ||'</td> 
			    <td style="text-align: center;font-size:10px;">'|| HTF.escape_sc (to_char(i.PAYMENTRECEIVEDDATE,'dd-mm-yy')) 
               ||'</td> 
			    <td style="text-align: center;font-size:10px;">'|| HTF.escape_sc (to_char(i.APPLYFORPRCDATE,'dd-mm-yy')) 
               ||'</td> 
			    
			    
			   '); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="8" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'|| HTF.escape_sc (to_char(v_exp ,'99,99,99,99,999')) 
               ||'</b></td> 
               <td></td> 
 
               <td><b>'||HTF.escape_sc (to_char(v_qty,'99,99,999')) 
               ||'</b></td> 
               <td></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (v_usd)||'</b></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (v_bdt)||'</b></td> 
               <td></td> 
               <td></td> 
                
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="16" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="5" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'|| HTF.escape_sc (to_char(v_exp_g)) 
               ||'</b></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (v_qty_g) 
               ||'</b></td> 
               <td></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (v_usd_g)||'</b></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (v_bdt_g)||'</b></td> 
               <td></td> 
               <td></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
     
	END;
 
--*****************************
 
procedure Document_submit_not_done      (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
 
        is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number      := 0; 
    v_p_usd number      := 0; 
    v_P_usd_g number    := 0; 
    v_P_bdt   number    := 0; 
    v_P_bdt_g number    := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' Document submit not done '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size:11px;"><tr> 
			<th style="width:1%" >SL.</th> 
			<th style="width:15%">Purchase Contact No</th> 
			<th style="width:10%">Comercial Invoice No</th> 
			<th style="width:5%">Comercial<br>Invoice Date</th> 
			<th style="width:5%">Exp No</th>  
			<th style="width:5%">EXP ISSUE<br> DATE</th> 
            <th style="width:5%">Factory Delivery Date</th> 
            <th style="width:4%">Bank</th> 
			<th style="width:3%"> Value USD</th> 
            <th style="width:7%">Items</th> 
			<th style="width:2%"> MT</th> 
			<th style="width:6%">Document Submit Date</th> 
			<th style="width:3%">Payment Received USD</th> 
			<th style="width:3%">Payment Received BDT</th> 
			<th style="width:4%">Payment Realized date</th> 
			<th style="width:4%"> Apply for PRC date</th> 
             
			</tr>'); 
			 
		FOR r in (SELECT CODE, CODE_DESC  
                    FROM G_UNI_CODES  
                    WHERE P_CODE =APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')||'0001' 
                    and CODE = nvl(p_company_name,code)  
                    and org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    ORDER BY CODE) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(DOCUMENTSUBMISSIONTOBANKDATE,p_to_date) between p_from_date and p_to_date 
                    and m.FACTORYDELIVERYDATE is not null 
                    and m.DOCUMENTSUBMISSIONTOBANKDATE is  null 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID); 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="16"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.CODE_DESC) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
            v_p_usd    := 0; 
            v_P_bdt    := 0; 
        	 
         for i in (select 	 
							m.PURCHASECONTACTID 
                    		,m.COMMERCIALINVOICENO 
                            ,m.COMMERCIALINVOICEDATE 
                            ,m.EXPFORMNO 
                            ,m.EXPFORMDATE 
                            ,m.FACTORYDELIVERYDATE 
                    		,b.SHORT_NAME 
                            ,d.VALUE_USD 
                    		,d.ITEM_NAME 
                    		,d.QTY 
							,m.DOCUMENTSUBMISSIONTOBANKDATE 
                            ,m.PAYMENTRECEIVEDUSD 
                            ,m.PAYMENTRECEIVEDBDT 
                            ,m.PAYMENTRECEIVEDDATE 
                            ,m.APPLYFORPRCDATE 
                            ,d.PC_CONTRACT_NO 
		 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(DOCUMENTSUBMISSIONTOBANKDATE,p_to_date) between p_from_date and p_to_date 
                    and m.FACTORYDELIVERYDATE is not null 
                    and m.DOCUMENTSUBMISSIONTOBANKDATE is  null 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID) 
                     ORDER BY m.FACTORYDELIVERYDATE DESC) 
                    loop 
            v_sl := v_sl+1; 
            v_tot_sl := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	v_usd      := v_usd+nvl(i.VALUE_USD,0); 
        	v_usd_g    := v_usd_g+nvl(i.VALUE_USD,0); 
            v_P_usd    := v_p_usd + nvl(i.PAYMENTRECEIVEDUSD,0); 
            v_P_usd_g    := v_P_usd_g + nvl(i.PAYMENTRECEIVEDUSD,0); 
            v_P_bdt    := v_P_bdt + nvl(i.PAYMENTRECEIVEDBDT,0); 
            v_P_bdt_g    := v_P_bdt_g + nvl(i.PAYMENTRECEIVEDBDT,0); 
        	 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (to_char(i.COMMERCIALINVOICEDATE,'dd-mm-yy')) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.EXPFORMDATE,'DD-MM-YY')) 
               || '</td> 
			    <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.FACTORYDELIVERYDATE,'DD-MM-YY')) 
               || '</td> 
               <td style="text-align: left">'||HTF.escape_sc (i.SHORT_NAME) 
                ||'</td> 
				 <td>'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td style="text-align: left;font-size:10px;">'|| HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
			    <td style="text-align: center">'|| HTF.escape_sc (TO_CHAR(i.DOCUMENTSUBMISSIONTOBANKDATE,'DD-MM-YY')) 
               ||'</td> 
			    <td style="text-align: right">'|| HTF.escape_sc (i.PAYMENTRECEIVEDUSD) 
               ||'</td> 
			    <td style="text-align: right">'|| HTF.escape_sc (i.PAYMENTRECEIVEDBDT) 
               ||'</td> 
			    <td style="text-align: center">'|| HTF.escape_sc (to_char(i.PAYMENTRECEIVEDDATE,'dd-mm-yy')) 
               ||'</td> 
			    <td style="text-align: center">'|| HTF.escape_sc (to_char(i.APPLYFORPRCDATE,'dd-mm-yy')) 
               ||'</td> 
			    
			    
			   '); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="8" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'|| HTF.escape_sc (to_char(v_exp,'99,99,999')) 
               ||'</b></td> 
               <td></td> 
 
               <td><b>'||HTF.escape_sc (to_char(v_qty)) 
               ||'</b></td> 
               <td></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (v_P_usd)||'</b></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (v_P_bdt)||'</b></td> 
               <td></td> 
               <td></td> 
                
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="16" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="5" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'|| HTF.escape_sc (TO_CHAR(v_exp_g,'99,99,999')) 
               ||'</b></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (v_qty_g) 
               ||'</b></td> 
               <td></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (v_P_usd_g)||'</b></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (v_P_bdt_g)||'</b></td> 
               <td></td> 
               <td></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
         
	END; 
 
--*******************************
 
 procedure ALL_INCOMPLETE_EXPORT (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number  := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' ALL INCOMPLETE EXPORT STATEMENT '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%"><tr> 
			<th style="width:1%" >SL.</th> 
            <th style="width:10%">Buyer Name</th> 
            <th style="width:5%">Factory Delivery Date</th> 
            <th style="width:5%">EXP No</th> 
            <th style="width:6%">EXP ISSUE<br> DATE</th> 
			<th style="width:15%">PURCHASE CONTRACT NO</th> 
			<th style="width:15%">Commercial Invoice No</th> 
			<th style="width:4%">Bank</th> 
            <th style="width:5%">ITEMS NAME</th> 
            <th style="width: 5px;">Quantity<br>(MT/Bale)</th>  
            <th style="width:5%">Export Value USD</th> 
			<th style="width:6%">Buyer Name</th> 
            <th style="width:6%">Payment Realisation Date</th> 
            <th style="width:6%">Amount Realise Usd</th> 
            <th style="width:5%">Delivery Done</th>				 
 
			</tr>'); 
			 
		FOR r in (SELECT CODE, CODE_DESC  
                    FROM G_UNI_CODES  
                    WHERE P_CODE =APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')||'0001' 
                    and CODE = nvl(p_company_name,code)  
                    and org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    ORDER BY CODE) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(FACTORYDELIVERYDATE,p_to_date) between p_from_date and p_to_date 
                    and m.FACTORYDELIVERYDATE is null 
                    and m.EXPDONE IN (upper( 'cancel'),upper( 'No')) 
 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID); 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="12"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.CODE_DESC) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
         for i in (select 	 m.FACTORYDELIVERYDATE 
                    		,m.EXPFORMNO 
                    		,m.EXPFORMDATE 
                    		,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
                            ,m.COMMERCIALINVOICEDATE 
                            ,(SELECT BUYER_NAME FROM ERP_BUYER_INFO WHERE BUYER_ID = d.BUYER_ID) BUYER_NAME 
                            -- ,b.BUYER_NAME 
                    		,b.SHORT_NAME 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                    		,d.VALUE_USD 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                    		,m.PAYMENTRECEIVEDDATE  
                    		,nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                    		,nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT 
                    		,m.EXPDONE 
                            ,M.PAYMENTRECEIVEDUSD 
                            ,M.PAYMENTRECEIVEDBDT 
                            ,M.APPLYFORPRCDATE 
                            ,M.APPLYFORBJMACERTIFICATEDATE 
                            ,M.REALIZATIONSUBSIDYBDT 
                            ,M.AUDITCERTIFICATERECEIVEDDATE 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(FACTORYDELIVERYDATE,p_to_date) between p_from_date and p_to_date 
                    and m.FACTORYDELIVERYDATE is null 
                    and m.EXPDONE IN (upper( 'cancel'),upper( 'No')) 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID) 
                     ORDER BY m.EXPDONE,m.FACTORYDELIVERYDATE DESC) 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	v_usd      := v_usd+nvl(i.PAYMENTRECEIVEDUSD,0); 
        	v_usd_g    := v_usd_g+nvl(i.PAYMENTRECEIVEDUSD,0); 
        	v_bdt      := v_bdt+nvl(i.REALIZATIONSUBSIDYBDT,0); 
        	v_bdt_g    := v_bdt_g+nvl(i.REALIZATIONSUBSIDYBDT,0); 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                 <td style="text-align: Left">' 
               || HTF.escape_sc (i.BUYER_NAME) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.FACTORYDELIVERYDATE,'DD-MM-YY')) 
               || '</td> 
                 <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                 <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.EXPFORMDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.SHORT_NAME) 
               || '</td> 
               <td style="text-align: left">' 
               || HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
                 <td style="text-align: ">'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td>'||HTF.escape_sc (null) 
               ||'</td> 
               <td>'|| HTF.escape_sc (to_char(i.PAYMENTRECEIVEDDATE,'dd-mm-yy')) 
               ||'</td> 
               <td style="text-align: right">'||HTF.escape_sc (to_char(i.PAYMENTRECEIVEDUSD,'99,99,99,999')) 
               ||'</td> 
               <td '||case when i.EXPDONE = 'CANCEL' then 'bgcolor= "yellow"' end ||'>'||HTF.escape_sc (i.EXPDONE) 
               ||'</td>'); 
 
 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="9" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'|| HTF.escape_sc (to_char(v_qty,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_exp)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td  style="text-align: right;" ><b>'||HTF.escape_sc (to_char(v_usd)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (null) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="15" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="6" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'|| HTF.escape_sc (TO_CHAR(v_qty_g,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (v_exp_g) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (to_char(v_usd_g)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(null)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
          
	END;
 
--******************************

 procedure PRC_NOT_Apply   (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
    is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_r_usd	 number		:= 0; 
	v_r_usd_g  number	:= 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number      := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' PRC NOT Apply '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size:11px;"><tr> 
			<th style="width:1%" >SL.</th> 
			<th style="width:5%">Factory Delivery<br> Date</th> 
			<th style="width:15%">Exp No</th>  
			<th style="width:10%">EXP ISSUE<br> DATE</th> 
			<th style="width:15%">Purchase Contact No</th> 
            <th style="width:10%">Comercial Invoice No</th> 
            <th style="width:7%">Bank</th> 
            <th style="width:7%">Item</th> 
			<th style="width:3%">Quantity<br>(MT/Bale)</th> 
			<th style="width:4%">Export Value USD</th>  
			<th style="width:6%">Document Submit Date</th> 
			<th style="width:6%">Payment Realisation Date</th> 
            <th style="width:4%">Amount Realise USD</th> 
            <th style="width:4%">Amount Realise BDT</th> 
            <th style="width:6%">PRC Apply Date</th> 
             
			</tr>'); 
			 
		FOR r in (SELECT BUYER_NAME BUYER_NAME, BUYER_ID  
                    FROM ERP_BUYER_INFO 
                    where BUYER_ID = nvl(p_buyer_name,BUYER_ID) 
                    AND org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
					and m.COMPANYID =nvl(p_company_name,m.COMPANYID)					 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and d.BUYER_ID = r.buyer_id 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    and m.PAYMENTRECEIVEDDATE is not null 
                    and m.APPLYFORPRCDATE is null 
                    and m.FACTORYDELIVERYDATE is not null 
                    ; 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="16"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.buyer_name) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	-- v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
         for i in (select 	 m.FACTORYDELIVERYDATE 
                    		,m.EXPFORMNO 
                    		,m.EXPFORMDATE 
                    		,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
                    		,b.SHORT_NAME 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                    		,d.VALUE_USD 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                    		,m.PAYMENTRECEIVEDDATE 
                    		,nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                    		,nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT 
                    		,m.EXPDONE 
                            ,m.APPLYFORPRCDATE 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
					and m.COMPANYID =nvl(p_company_name,m.COMPANYID) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and d.BUYER_ID = r.buyer_id 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(FACTORYDELIVERYDATE,p_to_date) between p_from_date and p_to_date 
                    and m.PAYMENTRECEIVEDDATE is not null 
                    and m.APPLYFORPRCDATE is null 
                    and m.FACTORYDELIVERYDATE is not null 
                     ORDER BY m.FACTORYDELIVERYDATE DESC 
 
                      ) 
                    loop 
            v_sl 		:= v_sl+1; 
         	v_tot_sl   	:= v_tot_sl+1; 
        	v_qty    	:=v_qty + nvl(i.QTY,0) ; 
			v_qty_g  	:=v_qty_g + nvl(i.QTY,0) ; 
			v_usd    	:=v_usd + nvl(i.VALUE_USD,0) ; 
			v_usd_g  	:=v_usd_g + nvl(i.VALUE_USD,0) ; 
			v_r_usd	 	:=v_r_usd + nvl(i.REALIZATIONAMOUNTUSD,0) ; 
			v_r_usd_g  	:=v_r_usd_g +nvl(i.REALIZATIONAMOUNTUSD,0); 
			v_bdt    	:=v_bdt + nvl(i.REALIZATIONAMOUNTBDT,0) ; 
			v_bdt_g  	:=v_bdt_g + nvl(i.REALIZATIONAMOUNTBDT,0) ; 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.FACTORYDELIVERYDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.EXPFORMDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
               <td style="text-align: left">'||HTF.escape_sc (i.SHORT_NAME) 
                ||'</td> 
               <td style="text-align: left">'|| HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
               <td>'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.DOCUMENTSUBMISSIONTOBANKDATE,'DD-MM-YY')) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.PAYMENTRECEIVEDDATE,'dd-mm-yy')) 
               ||'</td> 
               <td style="text-align: RIGHT">'||HTF.escape_sc (i.REALIZATIONAMOUNTUSD) 
               ||'</td> 
               <td style="text-align: RIGHT">'|| HTF.escape_sc (i.REALIZATIONAMOUNTBDT) 
               ||'</td> 
                <td>'||HTF.escape_sc (i.APPLYFORPRCDATE) 
               ||'</td> 
                <tr>'); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="8" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'|| HTF.escape_sc (to_char(v_qty,'99,99,999')) 
               ||'</b></td> 
               <td  style="text-align: right;" ><b>'||HTF.escape_sc (to_char(v_usd)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (to_char(v_r_usd,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt)) 
               ||'</b></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="16" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="5" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'|| HTF.escape_sc (TO_CHAR(v_qty_g,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_usd_g)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (v_r_usd_g) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt_g)) 
               ||'</b></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
         
	END; 
 
--******************************
 
 procedure PRC_NOT_available   (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
    is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_r_usd	 number		:= 0; 
	v_r_usd_g  number	:= 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number      := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' PRC NOT available '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size:11px;"><tr> 
			<th style="width:1%" >SL.</th> 
			<th style="width:5%">Factory Delivery<br> Date</th> 
			<th style="width:5%">Exp No</th>  
			<th style="width:5%">EXP ISSUE<br> DATE</th> 
			<th style="width:15%">Purchase Contact No</th> 
            <th style="width:10%">Comercial Invoice No</th> 
            <th style="width:7%">Bank</th> 
            <th style="width:7%">Item</th> 
			<th style="width:4%">Quantity<br>(MT/Bale</th> 
			<th style="width:4%">Export Value USD</th>  
			<th style="width:5%">Document Submit Date</th> 
			<th style="width:5%">Payment Realisation Date</th> 
            <th style="width:4%">Amount Realise USD</th> 
            <th style="width:4%">Amount Realise BDT</th> 
            <th style="width:2%">Expo Done</th> 
            <th style="width:6%">PRC Apply Date</th> 
             
			</tr>'); 
			 
		FOR r in (SELECT BUYER_NAME BUYER_NAME, BUYER_ID  
                    FROM ERP_BUYER_INFO 
                    where BUYER_ID = nvl(p_buyer_name,BUYER_ID) 
                    AND org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
					and m.COMPANYID = nvl(p_company_name,m.COMPANYID) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and d.BUYER_ID = r.BUYER_ID 
                    -- and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    and m.PAYMENTRECEIVEDDATE is not null 
                    and m.APPLYFORPRCDATE is NOT null 
                    and m.FACTORYDELIVERYDATE is not null 
                    and m.DOCUMENTSUBMISSIONTOBANKDATE is NOT null 
                    and m.PRC_RCV_DT is null 
                   ; 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="16"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.BUYER_NAME) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	-- v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
         for i in (select 	 m.FACTORYDELIVERYDATE 
                    		,m.EXPFORMNO 
                    		,m.EXPFORMDATE 
                    		,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
                    		,b.SHORT_NAME 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                    		,d.VALUE_USD 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                    		,m.PAYMENTRECEIVEDDATE 
                    		,nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                    		,nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT 
                    		,m.EXPDONE 
                            ,m.APPLYFORPRCDATE 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
					and m.COMPANYID = nvl(p_company_name,m.COMPANYID) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    -- and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and d.BUYER_ID = r.BUYER_ID 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(FACTORYDELIVERYDATE,p_to_date) between p_from_date and p_to_date 
                    and m.PAYMENTRECEIVEDDATE is not null 
                    and m.APPLYFORPRCDATE is NOT null 
                    and m.FACTORYDELIVERYDATE is not null 
                    and m.DOCUMENTSUBMISSIONTOBANKDATE is NOT null 
                    and m.PRC_RCV_DT is null 
                     ORDER BY m.FACTORYDELIVERYDATE DESC 
                   ) 
                    loop 
            v_sl 		:= v_sl+1; 
         	v_tot_sl   	:= v_tot_sl+1; 
        	v_qty    	:=v_qty + nvl(i.QTY,0) ; 
			v_qty_g  	:=v_qty_g + nvl(i.QTY,0) ; 
			v_usd    	:=v_usd + nvl(i.VALUE_USD,0) ; 
			v_usd_g  	:=v_usd_g + nvl(i.VALUE_USD,0) ; 
			v_r_usd	 	:=v_r_usd + nvl(i.REALIZATIONAMOUNTUSD,0) ; 
			v_r_usd_g  	:=v_r_usd_g +nvl(i.REALIZATIONAMOUNTUSD,0); 
			v_bdt    	:=v_bdt + nvl(i.REALIZATIONAMOUNTBDT,0) ; 
			v_bdt_g  	:=v_bdt_g + nvl(i.REALIZATIONAMOUNTBDT,0) ; 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.FACTORYDELIVERYDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (TO_CHAR(i.EXPFORMDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
               <td style="text-align: left">'||HTF.escape_sc (i.SHORT_NAME) 
                ||'</td> 
               <td style="text-align: left">'|| HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
               <td>'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.DOCUMENTSUBMISSIONTOBANKDATE,'DD-MM-YY')) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.PAYMENTRECEIVEDDATE,'dd-mm-yy')) 
               ||'</td> 
               <td style="text-align: RIGHT">'||HTF.escape_sc (i.REALIZATIONAMOUNTUSD) 
               ||'</td> 
               <td style="text-align: RIGHT">'|| HTF.escape_sc (i.REALIZATIONAMOUNTBDT) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.EXPDONE) 
               ||'</td> 
                <td>'||HTF.escape_sc (TO_CHAR(i.APPLYFORPRCDATE,'DD-MM-YY')) 
               ||'</td> 
                <tr>'); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="8" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'|| HTF.escape_sc (to_char(v_qty,'99,99,999')) 
               ||'</b></td> 
               <td  style="text-align: right;" ><b>'||HTF.escape_sc (to_char(v_usd)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (to_char(v_r_usd,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt)) 
               ||'</b></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="16" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="5" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'|| HTF.escape_sc (TO_CHAR(v_qty_g,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_usd_g)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (v_r_usd_g) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt_g)) 
               ||'</b></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
         
	END; 
 
--*****************************
 
	procedure Overdue_list  (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
	v_tot number     := 0; 
	v_tot_usd number     := 0; 
    v_tot_sl number    := 0; 
	 
    v_count number  := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' Overdue list  '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size:11px;"><tr> 
			<th style="width:1%" >SL.</th> 
			<th style="width:4%">Bank</th> 
			<th style="width:10%">Buyer Name</th>  
			<th style="width:5%">Exp No</th>  
			<th style="width:10%">Comercial Invoice No</th> 
			<th style="width:5%">EXP Year</th> 
			<th style="width:5%">Factory Delivery Date</th> 
			<th style="width:3%"> Delay Days</th> 
			<th style="width:5%"> Overdue Amount($)</th> 
            <th style="width:3%">Amount Realise USD</th> 
			</tr>'); 

		FOR r in (SELECT CODE, CODE_DESC  
                    FROM G_UNI_CODES  
                    WHERE P_CODE = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')||'0001' 
                    and CODE = nvl(p_company_name,code)  
                    and org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    ORDER BY CODE) 
		LOOP 
 
        select count(*) into v_count 
                    FROM  ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b, ERP_BUYER_INFO eb 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and d.BUYER_ID = eb.BUYER_ID 
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and m.COMPANYID = nvl(p_company_name,m.COMPANYID) 
                    and trunc(sysdate-m.FACTORYDELIVERYDATE)-121 > 0 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(FACTORYDELIVERYDATE,p_to_date) between p_from_date and p_to_date 
                    and FACTORYDELIVERYDATE is not null 
                    AND PAYMENTRECEIVEDDATE is null  
                    -- and m.PAYMENTRECEIVEDUSD is null 
                  ; 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="12"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.CODE_DESC) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
            v_tot       := 0; 
            
        	 
         for i in (select 	b.SHORT_NAME 
							,m.EXPFORMNO 
							,m.COMMERCIALINVOICENO 
							,m.ACTUALEXPORTDATE 
							,m.FACTORYDELIVERYDATE 
                            ,d.VALUE_USD 
							,nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                            ,eb.BUYER_NAME 
                            ,m.EXPFORMDATE 
                            ,trunc(sysdate-m.FACTORYDELIVERYDATE)-121 days 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b, ERP_BUYER_INFO eb 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and d.BUYER_ID = eb.BUYER_ID 
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and m.COMPANYID = nvl(p_company_name,m.COMPANYID) 
                    and trunc(sysdate-m.FACTORYDELIVERYDATE)-121 > 0 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(FACTORYDELIVERYDATE,p_to_date) between p_from_date and p_to_date 
                    and FACTORYDELIVERYDATE is not null 
                    AND PAYMENTRECEIVEDDATE is null  
                    -- and m.PAYMENTRECEIVEDUSD is null 
                     ORDER BY m.FACTORYDELIVERYDATE DESC 
                    ) 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
             v_tot      := v_tot+ nvl(i.VALUE_USD,0); 
            v_tot_usd :=v_tot_usd+ nvl(i.VALUE_USD,0); 
        	 
        	 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (i.SHORT_NAME) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (i.BUYER_NAME) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (to_char(i.EXPFORMDATE,'yyyy'))  --ACTUALEXPORTDATE 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.FACTORYDELIVERYDATE,'DD-MM-YY')) 
               || '</td> 
			    <td style="text-align: center">' 
               || HTF.escape_sc (i.days) 
               || '</td> 
               <td style="text-align: right">'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
                ||'</td> 
			 	 <td style="text-align: RIGHT">'||HTF.escape_sc (i.REALIZATIONAMOUNTUSD) 
                ||'</td> 
                
			    
			    
			   '); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="7" style="text-align: right;"><b>Total</b> :</td> 
               <td></td> 
 
               <td style="text-align: right;"><b>'||HTF.escape_sc (to_char(v_tot,'99,99,99,999.99')) 
               ||'</b></td><td></td> 
                
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="7" style="text-align: right;">.</td><tr> 
                <td colspan="5" style="text-align: right;"><b>Grand Total :</b></td> 
               <td colspan="4" style="text-align: right;"><b>'|| HTF.escape_sc (to_char(v_tot_usd,'99,99,99,999.99')) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
         
	END; 

--*******************************
 
	procedure Subsidy_amount_due (p_company_name varchar2,P_buyer_name varchar2,P_item_name varchar2,P_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number  := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' Subsidy amount due '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size:11px;"><tr> 
			<th style="width:1%" >SL.</th> 
			<th style="width:5%">Factory Delivery<br> Date</th> 
			<th style="width:17%">Buyer Name</th> 
			<th style="width:10%">Exp No</th>  
			<th style="width:16%">Purchase Contact No</th> 
            <th style="width:12%">Comercial Invoice No</th> 
            <th style="width:10%">Bank</th> 
            <th style="width:9%">Item</th> 
			<th style="width:2%">Quantity<br>(MT/Bale)</th> 
			<th style="width:2%">Value USD</th>  
			<th style="width:4%">Document Submit Date</th> 
			<th style="width:5%">Amount Realise Date</th> 
            <th style="width:1%">Amount Realise USD</th> 
            <th style="width:1%">Amount Realise BDT</th> 
            <th style="width:6%">Subsidy Apply Date</th> 
             
			</tr>'); 
						 
		FOR r in (SELECT CODE, CODE_DESC  
                    FROM G_UNI_CODES  
                    WHERE P_CODE =APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')||'0001' 
                    and CODE = nvl(p_company_name,code)  
                    and org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    ORDER BY CODE) 
		LOOP 
 
        select count(*) into v_count 
                     FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID (+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID) 
                    and nvl(APPLYFORSUBSIDYDATE,p_to_date) between p_from_date and p_to_date 
                    AND m.APPLYFORSUBSIDYDATE IS NOT NULL 
                    AND m.PAYMENTRECEIVEDDATE IS NOT NULL 
                    AND M.REALIZATIONDATE IS NULL 
                    -- AND nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD IS NULL 
                    ; 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="12"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.CODE_DESC) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
         for i in (select 	 m.FACTORYDELIVERYDATE 
                    		,m.EXPFORMNO 
                    		,m.EXPFORMDATE 
                            ,(SELECT BUYER_NAME FROM ERP_BUYER_INFO WHERE BUYER_ID = d.BUYER_ID) BUYER_NAME 
                    		,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
                    		,b.SHORT_NAME 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                    		,d.VALUE_USD 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                    		,m.PAYMENTRECEIVEDDATE 
                    		,nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                    		,nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT 
                    		,m.APPLYFORSUBSIDYDATE 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID (+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID) 
                    and nvl(APPLYFORSUBSIDYDATE,p_to_date) between p_from_date and p_to_date 
                    AND m.APPLYFORSUBSIDYDATE IS NOT NULL 
                    AND m.PAYMENTRECEIVEDDATE IS NOT NULL 
                    AND M.REALIZATIONDATE IS NULL 
                    -- AND nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD IS NULL 
                    ORDER BY m.APPLYFORSUBSIDYDATE asc
                    ) 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	v_usd      := v_usd+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_usd_g    := v_usd_g+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_bdt      := v_bdt+nvl(i.REALIZATIONAMOUNTBDT,0); 
        	v_bdt_g    := v_bdt_g+nvl(i.REALIZATIONAMOUNTBDT,0); 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (to_char(i.FACTORYDELIVERYDATE,'dd-mm-yy')) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.BUYER_NAME) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: left;font-size:10px;">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
               <td style="text-align: left">'||HTF.escape_sc (i.SHORT_NAME) 
                ||'</td> 
               <td style="text-align: CENTER">'|| HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
               <td style="text-align: right">'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.DOCUMENTSUBMISSIONTOBANKDATE,'dd-mm-yy')) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.PAYMENTRECEIVEDDATE,'dd-mm-yy')) 
               ||'</td> 
               <td style="text-align: right">'||HTF.escape_sc (i.REALIZATIONAMOUNTUSD) 
               ||'</td> 
               <td style="text-align: right">'|| HTF.escape_sc (i.REALIZATIONAMOUNTBDT) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.APPLYFORSUBSIDYDATE,'dd-mm-yy')) 
               ||'</td> 
                <tr>'); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="8" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'|| HTF.escape_sc (to_char(v_qty,'99,99,999')) 
               ||'</b></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (to_char(v_exp)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (to_char(v_usd)) 
               ||'</b></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (to_char(v_bdt)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="13" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="5" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'|| HTF.escape_sc (TO_CHAR(v_qty_g,'99,99,999')) 
               ||'</b></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (to_char(v_exp_g)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (to_char(v_usd_g)) 
               ||'</b></td> 
               <td style="text-align: right;"><b>'||HTF.escape_sc (to_char(v_bdt_g)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
         
	END;
 
--******************************
 
 procedure SUBSIDY_AMOUNT_DUE_ALL_EXPORT_BUYER_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number      := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' EXPORT STATEMENT SUBSIDY AMOUNT DUE (All Export) '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size: 11px;"><tr> 
			<th style="width:1%" >SL.</th> 
            <th style="width:5%">EXP No</th> 
            <th style="width:15%">PURCHASE CONTRACT NO</th> 
            <th style="width:5%">EXP ISSUE<br> DATE</th> 
			<th style="width:15%">Commercial Invoice No</th> 
			<th style="width:4%">Bank</th> 
            <th style="width:6%">ITEMS NAME</th> 
            <th style="width:4%;">Quantity<br>(MT/Bale)</th>  
            <th style="width:6%">Document Submit Date</th> 
            <th style="width:5%">Export Value USD</th> 
            <th style="width:7%">Subsidy Received BDT</th> 
            <th style="width:6%">PRC Apply Date</th> 
            <th style="width:6%">Subsidy Apply date</th> 
				 
 
			</tr>'); 
			 
		FOR r in (SELECT CODE, CODE_DESC  
                    FROM G_UNI_CODES  
                    WHERE P_CODE =APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')||'0001' 
                    and CODE = nvl(p_company_name,code)  
                    and org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    ORDER BY CODE) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(FACTORYDELIVERYDATE,p_to_date) between p_from_date and p_to_date 
                    and m.APPLYFORSUBSIDYDATE is null 
                    and FACTORYDELIVERYDATE is not null 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID); 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="12"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.CODE_DESC) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
            v_qty       :=0; 
        	 
         for i in (select 	 
                    		 m.EXPFORMNO 
                            ,d.PC_CONTRACT_NO 
                    		,m.EXPFORMDATE 
                    		,m.COMMERCIALINVOICENO 
                    		,b.SHORT_NAME 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                            ,d.VALUE_USD 
                            ,m.PAYMENTRECEIVEDBDT 
                            ,m.APPLYFORPRCDATE 
                            ,m.APPLYFORSUBSIDYDATE 
                    		 
                                                		 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(FACTORYDELIVERYDATE,p_to_date) between p_from_date and p_to_date 
                    and m.APPLYFORSUBSIDYDATE is null 
                    and FACTORYDELIVERYDATE is not null 
                    and nvl(m.COMPANYID,0) = nvl(r.code,m.COMPANYID)) 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
            v_qty      := v_qty + nvl(i.VALUE_USD,0); 
            v_qty_g    := v_qty_g  + nvl(i.value_usd,0); 
        	 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                 <td style="text-align: Left">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                 <td style="text-align: Left">' 
               || HTF.escape_sc (TO_CHAR(i.EXPFORMDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.SHORT_NAME) 
               || '</td> 
               <td style="text-align: left">' 
               || HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
                 <td>'||HTF.escape_sc (TO_CHAR(i.DOCUMENTSUBMISSIONTOBANKDATE,'DD-MM-YY')) 
               ||'</td> 
                 <td style="text-align: right">'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td style="text-align: right">'||HTF.escape_sc (i.PAYMENTRECEIVEDBDT) 
               ||'</td> 
               <td>'|| HTF.escape_sc (to_char(i.APPLYFORPRCDATE,'dd-mm-yy')) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.APPLYFORSUBSIDYDATE,'DD-MM-YY')) 
               ||'</td>'); 
 
 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="9" style="text-align: right;"><b>Total</b> :</td> 
               <td style="text-align: right"><b>'|| HTF.escape_sc (to_char(v_qty,'99,99,999')) 
               ||'</b></td> 
               
               <td></td> 
               <td></td> 
               <td></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="13" style="text-align: right;">.</td><tr> 
               <td colspan="2"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="7" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'|| HTF.escape_sc (TO_CHAR(v_qty_g,'99,99,999')) 
               ||'</b></td> 
               
               <td></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
         
	END;
 
--******************************
 
 
 procedure DOCUMENT_SUBMIT_BUYER_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number  := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' Export Done '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%"><tr> 
			<th style="width:1%" >SL.</th> 
            <th style="width:15%">Purchase Contact No</th> 
			<th style="width:10%">Commercial Invoice No</th> 
			<th style="width:5%">Commercial Invoice Date</th> 
			<th style="width:5%">Exp No</th> 
			<th style="width:4%">EXP ISSUE<br> DATE</th> 
			<th style="width:5%">FACTORY DELIVERY DATE</th> 
            <th style="width:4%">Bank</th> 
			<th style="width:3%">VALUE USD</th>  
            <th style="width:5%">Items</th>	 
			<th style="width:3%">MT</th>  
			<th style="width:3%">Doc Sub Date</th> 
            <th style="width:7%">PAYMENT RECEIVED USD</th> 
            <th style="width:7%">PAYMENT RECEIVED BDT</th>  
            <th style="width:7%">PAYMENT REALIZ DATE</th>			 
			<th style="width:7%">APPLY FOR PRC DATE</th> 
 
			</tr>'); 
			 
		FOR r in (SELECT SHORT_NAME BUYER_NAME, BUYER_ID  
                    FROM ERP_BUYER_INFO 
                    WHERE BUYER_ID = nvl(p_buyer_name,BUYER_ID) 
                    AND org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
					and m.COMPANYID = nvl(p_company_name,m.COMPANYID) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and d.BUYER_ID = r.BUYER_ID 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    ; 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="16"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.BUYER_NAME) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
         for i in (select 	 m.FACTORYDELIVERYDATE 
                    		,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
                            ,m.COMMERCIALINVOICEDATE 
                    		,m.EXPFORMNO 
                    		,m.EXPFORMDATE 
                    		,b.SHORT_NAME 
                    		,d.VALUE_USD 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                    		,nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                    		,nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT 
                            ,m.PAYMENTRECEIVEDDATE 
                    		,m.APPLYFORPRCDATE 
                   FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
					and m.COMPANYID = nvl(p_company_name,m.COMPANYID) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and d.BUYER_ID = r.BUYER_ID 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                     ORDER BY m.FACTORYDELIVERYDATE DESC 
                    ) 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	v_usd      := v_usd+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_usd_g    := v_usd_g+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_bdt      := v_bdt+nvl(i.REALIZATIONAMOUNTBDT,0); 
        	v_bdt_g    := v_bdt_g+nvl(i.REALIZATIONAMOUNTBDT,0); 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICEDATE) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (TO_CHAR(i.EXPFORMDATE,'DD-MM-YY')) 
               || '</td> 
               <td style="text-align: left">'||HTF.escape_sc (TO_CHAR(i.FACTORYDELIVERYDATE,'DD-MM-YY')) 
                ||'</td> 
               <td style="text-align: left">'|| HTF.escape_sc (i.SHORT_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.DOCUMENTSUBMISSIONTOBANKDATE,'DD-MM-YY')) 
               ||'</td> 
               <td style="text-align: RIGHT">'||HTF.escape_sc (i.REALIZATIONAMOUNTUSD) 
               ||'</td> 
               <td style="text-align: RIGHT">'|| HTF.escape_sc (i.REALIZATIONAMOUNTBDT) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.PAYMENTRECEIVEDDATE,'dd-mm-yy')) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.APPLYFORPRCDATE) 
               ||'</td> 
                <tr>'); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="8" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'||HTF.escape_sc (to_char(v_exp)) 
               ||'</b></td> 
               <td></td> 
               <td><b>'|| HTF.escape_sc (to_char(v_qty,'99,99,999')) 
               ||'</b></td> 
               <td></td> 
               <td  style="text-align: right;" ><b>'||HTF.escape_sc (to_char(v_usd)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="16" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="5" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'||HTF.escape_sc (v_exp_g) 
               ||'</b></td> 
               <td></td> 
               <td><b>'|| HTF.escape_sc (TO_CHAR(v_qty_g,'99,99,999')) 
               ||'</b></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (to_char(v_usd_g)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt_g)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
         
	END; 
    --****************************************** 
 procedure DOCUMENT_SUBMIT_NOT_DONE_BUYER_WISE (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number,p_from_date date,p_to_date date) 
is 
	 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number  := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, ' ALL INCOMPLETE EXPORT STATEMENT '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%"><tr> 
			<th style="width:1%" >SL.</th> 
            <th style="width:15%">PURCHASE CONTRACT NO</th> 
            <th style="width:15%">Commercial Invoice No</th> 
            <th style="width:15%">Commercial Invoice Date</th> 
            <th style="width:5%">EXP No</th> 
            <th style="width:4%">EXP ISSUE<br> DATE</th> 
             <th style="width:15%">Factory Delivery Date</th> 
			<th style="width:4%">Bank</th> 
            <th style="width:10%"> Value Usd</th> 
            <th style="width:5%">ITEMS NAME</th> 
            <th style="width: 5px;">MT</th>  
			<th style="width:6%">Document Submit Date</th> 
            <th style="width:7%">Payment Received USD</th> 
            <th style="width:7%">Payment Received BDT</th> 
            <th style="width:7%">Payment Realize Date</th> 
            <th style="width:7%">Apply For PRC Date</th>				 
 
			</tr>'); 
			 
		FOR r in (SELECT SHORT_NAME BUYER_NAME, BUYER_ID  
                    FROM ERP_BUYER_INFO 
                    WHERE BUYER_ID = nvl(p_buyer_name,BUYER_ID) 
                    AND org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
					and m.COMPANYID = nvl(p_company_name,m.COMPANYID)					 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and d.BUYER_ID = r.BUYER_ID 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    ; 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="12"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.BUYER_NAME) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
 
         for i in (select 	  
                            m.PURCHASECONTACTID 
                            ,m.COMMERCIALINVOICENO 
                            ,m.COMMERCIALINVOICEDATE 
                            ,m.EXPFORMNO 
                            ,m.EXPFORMDATE 
                            ,m.FACTORYDELIVERYDATE 
                    		,b.SHORT_NAME 
                            ,d.VALUE_USD 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                            ,M.PAYMENTRECEIVEDUSD 
                            ,M.PAYMENTRECEIVEDBDT 
                    		,m.PAYMENTRECEIVEDDATE 
                            ,M.APPLYFORPRCDATE 
                            ,d.PC_CONTRACT_NO 
 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
					and m.COMPANYID = nvl(p_company_name,m.COMPANYID)					 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and d.BUYER_ID = r.BUYER_ID 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    ) 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.PAYMENTRECEIVEDBDT,0); 
            v_exp_g    := v_exp_g+nvl(i.PAYMENTRECEIVEDBDT,0); 
        	v_usd      := v_usd+nvl(i.VALUE_USD,0); 
        	v_usd_g    := v_usd_g+nvl(i.VALUE_USD,0); 
        	 v_bdt      := v_bdt+nvl(i.PAYMENTRECEIVEDUSD,0); 
        	 v_bdt_g    := v_bdt_g+nvl(i.PAYMENTRECEIVEDUSD,0); 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                 <td style="text-align: Left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
                 <td style="text-align: Left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICEDATE) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (TO_CHAR(i.EXPFORMDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (TO_CHAR(i.FACTORYDELIVERYDATE,'DD-MM-YY')) 
               || '</td> 
               <td style="text-align: left">' 
               || HTF.escape_sc (i.SHORT_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
                 <td>'||HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
                 <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.DOCUMENTSUBMISSIONTOBANKDATE,'DD-MM-YY')) 
               ||'</td> 
               
               <td>'||HTF.escape_sc (i.PAYMENTRECEIVEDUSD) 
               ||'</td> 
                <td>'||HTF.escape_sc (i.PAYMENTRECEIVEDBDT) 
               ||'</td> 
                <td>'|| HTF.escape_sc (to_char(i.PAYMENTRECEIVEDDATE,'dd-mm-yy')) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.APPLYFORPRCDATE) 
               ||'</td>'); 
 
 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="8" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'|| HTF.escape_sc (to_char(v_usd)) 
               ||'</b></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (to_char(v_qty,'99,99,999')) 
               ||'</b></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (v_exp) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="16" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="5" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'|| HTF.escape_sc (to_char(v_usd_g)) 
               ||'</b></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (TO_CHAR(v_qty_g,'99,99,999')) 
               ||'</b></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (to_char(v_bdt_g)) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (v_exp_g) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
         
	END; 

--****************************

    procedure AUDIT_CERTIFICATE_NOT_RECEIVED  (p_company_name varchar2,p_buyer_name varchar2,p_item_name varchar2,p_bank_name number, 
                                                    p_from_date date,p_to_date date) 
    is 
	v_sl number         := 0; 
	v_tot_sl number     := 0; 
	v_qty    number     := 0; 
	v_qty_g  number     := 0; 
	v_exp    number     := 0; 
	v_exp_g  number     := 0; 
	v_usd    number     := 0; 
	v_usd_g  number     := 0; 
	v_bdt    number     := 0; 
	v_bdt_g  number     := 0; 
    v_count number  := 0; 
	BEGIN 
		report_utils.header_without_boarder(p_company_name, 'AUDIT CERTIFICATE NOT RECEIVED  '); 
        htp.p('<h4 style="margin-top: 0px; text-align: center">Date from : '||htf.escape_sc(P_from_date)||' to '||htf.escape_sc(P_To_date)||'</h4>'); 
		 
			htp.p('<table style="width:100%;font-size:11px;"><tr> 
			<th style="width:1%" >SL.</th> 
			<th style="width:3%">Factory Delivery<br> Date</th> 
			<th style="width:12%">Exp No</th> 
			<th style="width:13%">Purchase Contract No</th> 
			<th style="width:10%">Commercial Invoice No</th> 
			<th style="width:6%">Bank</th> 
            <th style="width:7%">Item</th> 
			<th style="width:2%">Quantity<br>(MT/Bale)</th> 
			<th style="width:3%">Export Value USD</th>  
			<th style="width:5%">Document Submit Date</th> 
            <th style="width:5%">Payment Realisation Date</th> 
            <th style="width:5%">Subsidy Apply Date</th>  
            <th style="width:4%">Audit Receive Date</th>				 
 
			</tr>'); 
			 
		FOR r in (SELECT SHORT_NAME BANK_NAME,BANK_ID 
					FROM ERP_BANK_INFO 
					WHERE BANK_ID=NVL(p_bank_name,BANK_ID) 
                    and org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')) 
		LOOP 
 
        select count(*) into v_count 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
					and m.COMPANYID =NVL(p_company_name, m.COMPANYID) 
                    and nvl(m.BANK,0) = NVL(R.BANK_ID,0) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    and FACTORYDELIVERYDATE is not null
                    and m.AUDITCERTIFICATERECEIVEDDATE is  null 
                   and m.REALIZATIONDATE is null
                   AND  m.PAYMENTRECEIVEDDATE IS NOT NULL
                   and m.APPLYFORSUBSIDYDATE is not null
                   AND M.DOCUMENTSUBMISSIONTOBANKDATE IS NOT NULL
                     ORDER BY m.FACTORYDELIVERYDATE DESC; 
if v_count > 0 then 
            HTP.p ( 
                  '<tr> 
                <td colspan="12"  style="text-align: left"><b>' 
               || HTF.escape_sc (r.BANK_NAME) 
               || '</b></td> 
                <tr>'); 
end if;                 
            v_sl       := 0; 
        	v_qty      := 0; 
        	v_exp      := 0; 
        	v_usd      := 0; 
        	v_bdt      := 0; 
         for i in (select 	 m.FACTORYDELIVERYDATE 
                    		,m.EXPFORMNO 
                    		,m.EXPFORMDATE 
                    		,d.PC_CONTRACT_NO 
                    		,m.COMMERCIALINVOICENO 
                    		,b.SHORT_NAME 
                    		,d.ITEM_NAME 
                    		,d.QTY 
                    		,d.VALUE_USD 
                    		,m.DOCUMENTSUBMISSIONTOBANKDATE 
                            ,m.APPLYFORSUBSIDYDATE
                    		,m.PAYMENTRECEIVEDDATE 
                    		,nvl(m.REALIZATIONAMOUNTUSD,m.PAYMENTRECEIVEDUSD) REALIZATIONAMOUNTUSD 
                    		,nvl(m.REALIZATIONAMOUNTBDT,m.PAYMENTRECEIVEDBDT) REALIZATIONAMOUNTBDT 
                    		,m.AUDITCERTIFICATERECEIVEDDATE 
                    FROM ERP_PROFORMA_INVOICE m, ERP_PURCHASE_CONTRACT d, ERP_BANK_INFO b 
                    where m.PURCHASECONTACTID = d.PC_ID(+)  
                    and m.BANK = b.BANK_ID (+)  
                    and M.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')  
                    and D.org_id = APEX_UTIL.FETCH_APP_ITEM('APP_ORG_ID')   
					and m.COMPANYID =NVL(p_company_name, m.COMPANYID) 
                    and nvl(m.BANK,0) = NVL(R.BANK_ID,0) 
                    and nvl(d.ITEM_NAME,0) = nvl(p_item_name,nvl(d.ITEM_NAME,0)) 
                    and nvl(d.BUYER_ID,0) = nvl(p_buyer_name,BUYER_ID) 
                    and nvl(m.BANK,0) = nvl(p_bank_name,nvl(m.BANK,0)) 
                    and nvl(EXPFORMDATE,p_to_date) between p_from_date and p_to_date 
                    and m.AUDITCERTIFICATERECEIVEDDATE is  null 
                    and FACTORYDELIVERYDATE is not null
                   and m.REALIZATIONDATE is null
                   AND  m.PAYMENTRECEIVEDDATE IS NOT NULL
                   and m.APPLYFORSUBSIDYDATE is not null
                   AND M.DOCUMENTSUBMISSIONTOBANKDATE IS NOT NULL
                     ORDER BY m.APPLYFORSUBSIDYDATE asc) 
                    loop 
            v_sl := v_sl+1; 
         	v_tot_sl   := v_tot_sl+1; 
        	v_qty      := v_qty+nvl(i.QTY,0); 
        	v_qty_g    := v_qty_g+nvl(i.QTY,0); 
        	v_exp      := v_exp+nvl(i.VALUE_USD,0); 
        	v_exp_g    := v_exp_g+nvl(i.VALUE_USD,0); 
        	v_usd      := v_usd+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_usd_g    := v_usd_g+nvl(i.REALIZATIONAMOUNTUSD,0); 
        	v_bdt      := v_bdt+nvl(i.REALIZATIONAMOUNTBDT,0); 
        	v_bdt_g    := v_bdt_g+nvl(i.REALIZATIONAMOUNTBDT,0); 
            HTP.p ( 
                  '<tr> 
                <td style="text-align: center">' 
               || HTF.escape_sc (v_sl) 
               || '</td> 
                <td style="text-align: center">' 
               || HTF.escape_sc (TO_CHAR(i.FACTORYDELIVERYDATE,'DD-MM-YY')) 
               || '</td> 
                <td style="text-align: Left">' 
               || HTF.escape_sc (i.EXPFORMNO) 
               || '</td>  
                <td style="text-align: left">' 
               || HTF.escape_sc (i.PC_CONTRACT_NO) 
               || '</td> 
                <td style="text-align: left">' 
               || HTF.escape_sc (i.COMMERCIALINVOICENO) 
               || '</td> 
               <td style="text-align: left;font-size:10px;">'||HTF.escape_sc (i.SHORT_NAME) 
                ||'</td> 
               <td style="text-align: left">'|| HTF.escape_sc (i.ITEM_NAME) 
               ||'</td> 
               <td>'||HTF.escape_sc (i.QTY) 
               ||'</td> 
               <td>'||HTF.escape_sc ( to_char(i.VALUE_USD,'99,99,999')) 
               ||'</td> 
               <td>'||HTF.escape_sc (TO_CHAR(i.DOCUMENTSUBMISSIONTOBANKDATE,'DD-MM-YY')) 
               ||'</td> 
               <td>'||HTF.escape_sc (to_char(i.PAYMENTRECEIVEDDATE,'dd-mm-yy')) 
               ||'</td> 
               <td style="text-align: CENTER">'||HTF.escape_sc (TO_CHAR(i.APPLYFORSUBSIDYDATE,'DD-MM-YY')) 
               ||'</td>  
               <td>'||HTF.escape_sc (i.AUDITCERTIFICATERECEIVEDDATE) 
               ||'</td> 
                <tr>'); 
			end loop; 
 
if v_count > 0 then             
            HTP.p ( 
                  '<tr> 
                <td colspan="7" style="text-align: right;"><b>Total</b> :</td> 
               <td><b>'|| HTF.escape_sc (to_char(v_qty,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (to_char(v_exp)) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td  style="text-align: right;" ><b>'||HTF.escape_sc (to_char(NULL)) 
               ||'</b></td> 
               <td></td> 
                <tr>'); 
end if; 
	 
		end loop; 
         
 
            HTP.p ( 
                  '<tr> 
                <td colspan="14" style="text-align: right;">.</td><tr> 
               <td colspan="3"><b>Total Retult : '||HTF.escape_sc (v_tot_sl) 
               ||'</b></td> 
                <td colspan="4" style="text-align: right;"><b>Grand Total :</b></td> 
               <td><b>'|| HTF.escape_sc (TO_CHAR(v_qty_g,'99,99,999')) 
               ||'</b></td> 
               <td><b>'||HTF.escape_sc (v_exp_g) 
               ||'</b></td> 
               <td></td> 
               <td></td> 
               <td><b>'||HTF.escape_sc (to_char(NULL)) 
               ||'</b></td>
               <td></td> 
                <tr>'); 
         
			htp.p('</table>'); 
 
		report_utils.footer; 
        
	END;
 
--**************************

end "EXPORT_REPORTS";
/



